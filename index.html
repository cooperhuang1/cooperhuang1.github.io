<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>太阳系边际探测：交互式探索</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        /* Base Styles - Dark Theme */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background-color: #0f172a; /* Deep space background */
            color: #e2e8f0; /* Light text for contrast */
            line-height: 1.6;
            overflow-x: hidden; /* Prevent horizontal scroll due to 3D elements */
        }
        .section-title {
            color: #818cf8; /* Vibrant purple-blue for titles */
            text-shadow: 0 0 8px rgba(129, 140, 248, 0.5); /* Subtle glow */
        }
        .card {
            background-color: #1a202c; /* Darker card background */
            border-radius: 0.75rem; /* More rounded corners */
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1); /* Stronger shadow */
            border: 1px solid rgba(129, 140, 248, 0.2); /* Subtle border glow */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.3), 0 6px 10px -3px rgba(0, 0, 0, 0.15);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            margin: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, transform 0.2s, box-shadow 0.3s;
            background-color: #334155; /* Dark grey */
            color: #cbd5e1; /* Light grey text */
            font-weight: 600;
            border: 1px solid #475569;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .tab-button:hover {
            background-color: #475569;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .tab-button.active {
            background-color: #818cf8; /* Vibrant purple-blue */
            color: #ffffff;
            border-color: #a78bfa;
            box-shadow: 0 4px 10px rgba(129, 140, 248, 0.4);
            transform: translateY(0);
        }
        .timeline {
            position: relative;
            padding-left: 2.5rem; /* More space for icons */
            border-left: 3px solid #6366f1; /* Stronger timeline line */
        }
        .timeline-item {
            position: relative;
            margin-bottom: 2.5rem;
            padding: 1rem 1.5rem;
            background-color: #2d3748; /* Darker item background */
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        .timeline-item:hover {
            background-color: #3a475a; /* Slightly lighter on hover */
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        .timeline-icon {
            position: absolute;
            left: -1.75rem; /* Adjust position to align with line */
            top: 0.75rem;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            background-color: #6366f1; /* Purple-blue icon background */
            border: 3px solid #0f172a; /* Matches body background */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
            z-index: 10;
            box-shadow: 0 0 10px rgba(99, 102, 241, 0.6); /* Glow effect */
        }
        .boundary-card {
            border: 1px solid rgba(129, 140, 248, 0.3);
            background-color: #1f2937; /* Darker background for boundary cards */
            color: #cbd5e1;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s;
        }
        .boundary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.15);
            border-color: #818cf8; /* Glow on hover */
        }
        .boundary-card h3 {
            color: #a78bfa; /* Lighter purple for titles */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            color: #cbd5e1;
            font-weight: 500;
            transition: color 0.3s, text-shadow 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: #818cf8;
            text-shadow: 0 0 5px rgba(129, 140, 248, 0.7);
        }
        .chartjs-tooltip {
            background: rgba(30, 41, 59, 0.9); /* Darker tooltip */
            color: white;
            border-radius: 0.375rem;
            padding: 0.5rem;
            font-size: 0.875rem;
            border: 1px solid rgba(129, 140, 248, 0.3);
        }
        .llm-button {
            background: linear-gradient(45deg, #6366f1, #818cf8); /* Gradient button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.4);
            border: none;
        }
        .llm-button:hover:not(:disabled) {
            background: linear-gradient(45deg, #4f46e5, #6d28d9); /* Darker gradient on hover */
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.6);
            transform: translateY(-2px);
        }
        .llm-button:disabled {
            background-color: #475569;
            cursor: not-allowed;
            box-shadow: none;
        }
        .llm-textarea {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.375rem;
            background-color: #2d3748; /* Darker input */
            border: 1px solid #475569;
            color: #e2e8f0;
            resize: vertical;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .planet-indicator {
            position: absolute;
            top: -5px; /* Adjust for larger size */
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #0f172a; /* Matches body background */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* Stronger glow */
            transform: scale(0);
            opacity: 0;
            transition: transform 0.4s ease-out, opacity 0.4s ease-out, box-shadow 0.4s ease-out;
            transform-origin: center center;
        }
        .planet-indicator.animate-in {
            transform: scale(1);
            opacity: 1;
        }
        .planet-indicator:hover {
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            transform: scale(1.2);
        }
        .planet-card-item {
            border: 1px solid #475569;
            border-radius: 0.5rem;
            background-color: #1f2937;
            padding: 1.25rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            color: #cbd5e1;
        }
        .planet-card-item h2 {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #a78bfa;
        }
        .planet-card-item p {
            font-size: 0.9rem;
            color: #94a3b8;
        }
        .planet-modal-content {
            padding: 1.5rem;
            background-color: #1f2937;
            color: #e2e8f0;
            border-radius: 0.5rem;
        }
        .planet-modal-content p {
            margin-bottom: 0.75rem;
        }

        /* Solar System Multiple Boundaries Diagram */
        .boundary-diagram-wrapper {
            overflow-x: auto;
            padding-bottom: 1.5rem;
        }
        .boundary-diagram-container {
            position: relative;
            width: 100%;
            min-width: 900px; /* Increased min-width */
            height: 280px; /* Increased height */
            background: linear-gradient(to right, #1f2937, #2d3748, #334155, #475569, #64748b); /* Darker, more subtle gradient */
            border-radius: 0.75rem;
            display: flex;
            align-items: flex-end;
            padding: 0 1.5rem;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.4);
            border: 1px solid rgba(129, 140, 248, 0.2);
        }
        .boundary-segment {
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            text-align: center;
            padding: 0.75rem;
            color: #e2e8f0;
            font-size: 0.9rem;
            font-weight: 500;
            opacity: 0.9;
            box-sizing: border-box;
            min-width: 140px; /* Increased min-width */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, background-color 0.3s;
            border-radius: 0.5rem;
            margin: 0.25rem; /* Small margin between segments */
        }
        .boundary-segment:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0,0,0,0.4);
            background-color: rgba(129, 140, 248, 0.1); /* Subtle highlight on hover */
        }
        .boundary-segment strong {
            font-weight: 700;
            color: #a78bfa; /* Purple for strong text */
            margin-bottom: 0.5rem;
            line-height: 1.3;
            font-size: 1.25rem;
            text-shadow: 0 0 5px rgba(167, 139, 250, 0.5);
        }
        .boundary-segment .visual-cue {
            font-size: 3.5rem; /* Larger emoji */
            line-height: 1;
            margin-bottom: 0.75rem;
            display: block;
            color: #60a5fa; /* Blue for cues */
            text-shadow: 0 0 10px rgba(96, 165, 250, 0.7);
        }
        .boundary-segment-label {
            white-space: normal;
            font-size: 0.8rem;
            color: #94a3b8;
            line-height: 1.3;
            margin-top: auto;
        }
        /* Specific background colors for visual distinction (more subtle) */
        .boundary-segment:nth-child(1) { background-color: rgba(251, 191, 36, 0.05); }
        .boundary-segment:nth-child(2) { background-color: rgba(52, 211, 153, 0.05); }
        .boundary-segment:nth-child(3) { background-color: rgba(59, 130, 246, 0.05); }
        .boundary-segment:nth-child(4) { background-color: rgba(239, 68, 68, 0.05); }
        .boundary-segment:nth-child(5) { background-color: rgba(99, 102, 241, 0.05); }
        .boundary-segment:nth-child(6) { background-color: rgba(168, 85, 247, 0.05); }

        /* Styles for Voyager Timeline Detail */
        #voyagerDetailArea {
            background-color: #1f2937;
            border: 1px solid #475569;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-top: 2rem;
            display: none;
            box-shadow: inset 0 0 10px rgba(129, 140, 248, 0.2);
            color: #e2e8f0;
        }
        #voyagerDetailArea h3 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #a78bfa;
            margin-bottom: 1rem;
            text-shadow: 0 0 5px rgba(167, 139, 250, 0.5);
        }
        #voyagerDetailArea p {
            color: #cbd5e1;
            margin-bottom: 0.75rem;
        }
        #voyagerDetailArea ul {
            list-style: disc;
            list-style-position: inside;
            margin-left: 1.5rem;
            color: #cbd5e1;
        }
        #voyagerDetailArea ul li {
            margin-bottom: 0.5rem;
        }
        #voyagerDetailArea h4 {
            color: #60a5fa;
            text-shadow: 0 0 3px rgba(96, 165, 250, 0.3);
        }

        /* Styles for Probe Design Section */
        .design-step {
            background-color: #1f2937;
            border: 1px solid #475569;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            color: #e2e8f0;
        }
        .design-step h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #818cf8;
            margin-bottom: 1rem;
            text-shadow: 0 0 5px rgba(129, 140, 248, 0.5);
        }
        .component-option {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid #475569;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s;
            background-color: #2d3748;
        }
        .component-option:hover {
            background-color: #334155;
            border-color: #6366f1;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);
        }
        .component-option.selected {
            background-color: #4338ca; /* Darker blue for selected */
            border-color: #818cf8;
            box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.7); /* Stronger glow */
        }
        .component-option input[type="radio"] {
            margin-right: 1rem;
            accent-color: #818cf8; /* Style radio button */
        }
        .component-info {
            flex-grow: 1;
        }
        .component-info strong {
            color: #e2e8f0;
            font-size: 1.05rem;
        }
        .component-stats {
            font-size: 0.875rem;
            color: #94a3b8;
            margin-top: 0.25rem;
        }
        #probeSummary {
            background-color: #1f2937;
            border: 1px solid #475569;
            padding: 2rem;
            border-radius: 0.75rem;
            margin-top: 2.5rem;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            color: #e2e8f0;
        }
        #probeSummary h3 {
            color: #34d399; /* Green for success */
            text-shadow: 0 0 5px rgba(52, 211, 153, 0.5);
        }
        #probeSummary p {
            color: #a7f3d0;
        }
        #designFeedback {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: #1f2937;
            border: 1px solid #475569;
            border-radius: 0.75rem;
            color: #e2e8f0;
            box-shadow: inset 0 0 8px rgba(251, 191, 36, 0.2);
        }
        #designFeedback p {
            color: #fcd34d; /* Yellow for feedback */
        }
        #totalScore {
            font-size: 2rem;
            font-weight: bold;
            color: #818cf8;
            margin-top: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
            text-shadow: 0 0 10px rgba(129, 140, 248, 0.7);
        }

        /* Styles for Probe Simulation Section */
        .simulation-status {
            background-color: #1f2937;
            border: 1px solid #475569;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            font-size: 1.05rem;
            color: #e2e8f0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .simulation-status p {
            margin-bottom: 0;
            color: #cbd5e1;
        }
        .simulation-status strong {
            color: #a78bfa;
        }
        .simulation-log {
            background-color: #1f2937;
            border: 1px solid #475569;
            padding: 1.5rem;
            border-radius: 0.75rem;
            max-height: 350px; /* Increased height */
            overflow-y: auto;
            margin-top: 1.5rem;
            font-size: 0.95rem;
            color: #94a3b8;
            box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
        }
        .simulation-log p {
            margin-bottom: 0.5rem;
            border-bottom: 1px dashed rgba(71, 85, 105, 0.3); /* Subtle separator */
            padding-bottom: 0.5rem;
        }
        .simulation-log p:last-child {
            border-bottom: none;
        }
        .simulation-log p.text-red-600 { color: #f87171; }
        .simulation-log p.text-green-600 { color: #4ade80; }
        .simulation-log p.text-blue-700 { color: #60a5fa; }

        .simulation-event {
            background-color: #2d3748;
            border: 1px solid #475569;
            padding: 2rem;
            border-radius: 0.75rem;
            margin-top: 1.5rem;
            font-size: 1.1rem;
            color: #e2e8f0;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        .simulation-event strong {
            color: #818cf8;
            text-shadow: 0 0 5px rgba(129, 140, 248, 0.5);
        }
        .simulation-choices {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .simulation-choices .choice-button {
            background: linear-gradient(45deg, #60a5fa, #818cf8);
            color: white;
            padding: 0.9rem 1.8rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(96, 165, 250, 0.4);
            border: none;
        }
        .simulation-choices .choice-button:hover {
            background: linear-gradient(45deg, #3b82f6, #6366f1);
            box-shadow: 0 6px 12px rgba(96, 165, 250, 0.6);
            transform: translateY(-2px);
        }
        .simulation-choices .choice-button:disabled {
            background-color: #475569;
            cursor: not-allowed;
            box-shadow: none;
        }
        .simulation-result {
            background-color: #1f2937;
            border: 1px solid #475569;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 1.5rem;
            font-size: 1.05rem;
            color: #e2e8f0;
            box-shadow: inset 0 0 10px rgba(52, 211, 153, 0.2);
        }
        .simulation-game-over {
            background-color: #450a0a; /* Dark red */
            border: 2px solid #ef4444;
            padding: 2rem;
            border-radius: 0.75rem;
            margin-top: 2rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #f87171; /* Light red */
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.6);
        }
        .simulation-win {
            background-color: #064e3b; /* Dark green */
            border: 2px solid #10b981;
            padding: 2rem;
            border-radius: 0.75rem;
            margin-top: 2rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #4ade80; /* Light green */
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
        }

        /* Game specific styles */
        #gameCanvas {
            background-color: #0f172a; /* Deep space background */
            cursor: crosshair;
            border: 2px solid #6366f1; /* Purple border */
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.7); /* Glowing border */
            border-radius: 0.75rem;
        }
        .game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 800px;
            margin-bottom: 1.5rem;
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 600;
            text-shadow: 0 0 5px rgba(129, 140, 248, 0.3);
        }
        .game-controls button {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
            border: none;
            transition: all 0.2s ease-in-out;
            transform: translateY(0);
            background: linear-gradient(45deg, #6366f1, #818cf8);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        .game-controls button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 12px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15);
            background: linear-gradient(45deg, #4f46e5, #6d28d9);
        }
        .game-controls button:active {
            transform: translateY(0);
            box-shadow: none;
        }
        .game-controls button.bg-red-500 {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }
        .game-controls button.bg-red-500:hover {
            background: linear-gradient(45deg, #dc2626, #b91c1c);
        }
        .game-controls button.bg-green-500 {
            background: linear-gradient(45deg, #22c55e, #16a34a);
        }
        .game-controls button.bg-green-500:hover {
            background: linear-gradient(45deg, #16a34a, #065f46);
        }

        .explosion {
            animation: explode 0.5s forwards;
            opacity: 0;
        }
        @keyframes explode {
            0% { transform: scale(0.5); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
            100% { transform: scale(2); opacity: 0; }
        }
        .game-message-display {
            margin-top: 1.5rem;
            font-size: 1.75rem;
            font-weight: bold;
            text-align: center;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        .game-message-display.text-green-500 { color: #4ade80; }
        .game-message-display.text-red-500 { color: #f87171; }
        .game-message-display.text-blue-500 { color: #60a5fa; }
        .game-message-display.text-gold-500 { color: #facc15; } /* For win message */

        /* Modal specific styles */
        .fixed.inset-0.bg-gray-600.bg-opacity-50 {
            background-color: rgba(15, 23, 42, 0.8); /* Darker overlay */
        }
        .relative.mx-auto.p-5.border.shadow-lg.rounded-md.bg-white {
            background-color: #1f2937;
            border: 1px solid #475569;
            color: #e2e8f0;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }
        .relative.mx-auto.p-5.border.shadow-lg.rounded-md.bg-white h3 {
            color: #818cf8;
            text-shadow: 0 0 5px rgba(129, 140, 248, 0.5);
        }
        .relative.mx-auto.p-5.border.shadow-lg.rounded-md.bg-white button {
            background: linear-gradient(45deg, #6366f1, #818cf8);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.4);
        }
        .relative.mx-auto.p-5.border.shadow-lg.rounded-md.bg-white button:hover {
            background: linear-gradient(45deg, #4f46e5, #6d28d9);
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.6);
            transform: translateY(-2px);
        }

        /* 3D Canvas Styles */
        .three-d-canvas {
            width: 100%;
            height: 400px; /* Fixed height for 3D canvas */
            background-color: #000;
            border-radius: 0.75rem;
            border: 1px solid rgba(129, 140, 248, 0.2);
            box-shadow: inset 0 0 15px rgba(0,0,0,0.4);
            margin-top: 2rem;
        }

        /* Nuclear Power 3D Visualizations */
        .nuclear-power-canvas {
            width: 100%;
            height: 250px;
            background-color: #000;
            border-radius: 0.75rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
            box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
            margin-top: 1.5rem;
        }

    </style>
</head>
<body class="antialiased">

    <nav class="sticky top-0 z-50 bg-gray-900/90 backdrop-blur-md shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="text-2xl font-bold text-blue-400">太阳系边际探索</div>
                <div class="hidden md:flex space-x-4">
                    <a href="#blueprint" class="nav-link">宏伟蓝图</a>
                    <a href="#boundaries" class="nav-link">探索边界</a>
                    <a href="#scaled-map" class="nav-link">比例尺地图</a>
                    <a href="#mysteries" class="nav-link">科学奥秘</a>
                    <a href="#earth-importance" class="nav-link">地球重要性</a>
                    <a href="#qa" class="nav-link">知识问答</a>
                    <a href="#technology" class="nav-link">技术之巅</a>
                    <a href="#nuclear-power-principles" class="nav-link">未来动力原理</a>
                    <a href="#pioneers" class="nav-link">先行者之路</a>
                    <a href="#voyager-special" class="nav-link">旅行者专题</a>
                    <a href="#china-action" class="nav-link">中国行动</a>
                    <a href="#future" class="nav-link">未来征程</a>
                    <a href="#design-probe" class="nav-link">设计探测器</a>
                    <a href="#probe-simulation" class="nav-link">探测关卡</a>
                    <a href="#mission-inspiration" class="nav-link">任务灵感</a>
                    <a href="#fact-generator" class="nav-link">趣味事实</a>
                </div>
                <div class="md:hidden">
                    <button id="mobileMenuButton" class="text-slate-300 focus:outline-none">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobileMenu" class="hidden md:hidden bg-gray-900 shadow-lg">
            <a href="#blueprint" class="block py-3 px-4 text-sm nav-link">宏伟蓝图</a>
            <a href="#boundaries" class="block py-3 px-4 text-sm nav-link">探索边界</a>
            <a href="#scaled-map" class="block py-3 px-4 text-sm nav-link">比例尺地图</a>
            <a href="#mysteries" class="block py-3 px-4 text-sm nav-link">科学奥秘</a>
            <a href="#earth-importance" class="block py-3 px-4 text-sm nav-link">地球重要性</a>
            <a href="#qa" class="block py-3 px-4 text-sm nav-link">知识问答</a>
            <a href="#technology" class="block py-3 px-4 text-sm nav-link">技术之巅</a>
            <a href="#nuclear-power-principles" class="block py-3 px-4 text-sm nav-link">未来动力原理</a>
            <a href="#pioneers" class="block py-3 px-4 text-sm nav-link">先行者之路</a>
            <a href="#voyager-special" class="block py-3 px-4 text-sm nav-link">旅行者专题</a>
            <a href="#china-action" class="block py-3 px-4 text-sm nav-link">中国行动</a>
            <a href="#future" class="block py-3 px-4 text-sm nav-link">未来征程</a>
            <a href="#design-probe" class="block py-3 px-4 text-sm nav-link">设计探测器</a>
            <a href="#probe-simulation" class="block py-3 px-4 text-sm nav-link">探测关卡</a>
            <a href="#mission-inspiration" class="block py-3 px-4 text-sm nav-link">任务灵感</a>
            <a href="#fact-generator" class="block py-3 px-4 text-sm nav-link">趣味事实</a>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8">

        <section id="blueprint" class="pt-16 -mt-16 mb-16">
            <div class="card text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8">宏伟蓝图：界定太阳系的边际</h2>
                <p class="text-xl text-slate-300 mb-10 max-w-4xl mx-auto">
                    人类对宇宙的探索，始于对家园边界的求索。太阳系的边界并非单一界线，而是由多种物理现象定义的多层次区域，每一层都揭示了太阳系演化历史的不同篇章。本应用将带您一同探索这些遥远的边际，理解其科学意义与面临的技术挑战。
                </p>
                <div class="p-8 border border-blue-700 rounded-xl bg-gray-800 shadow-xl">
                    <h3 class="text-2xl font-semibold text-blue-400 mb-6">太阳系多重边界示意图</h3>
                    <div class="boundary-diagram-wrapper">
                        <div class="boundary-diagram-container">
                            <div class="boundary-segment">
                                <span class="visual-cue">◎</span> <strong>行星轨道</strong>
                                <span class="boundary-segment-label">0.4 - 30 AU</span>
                            </div>
                            <div class="boundary-segment">
                                <span class="visual-cue">✶</span> <strong>柯伊伯带</strong>
                                <span class="boundary-segment-label">30 - 1,000 AU</span>
                            </div>
                            <div class="boundary-segment">
                                <span class="visual-cue">☊</span> <strong>日球层顶</strong>
                                <span class="boundary-segment-label">~120 - 140 AU</span>
                            </div>
                            <div class="boundary-segment">
                                <span class="visual-cue">♨</span> <strong>热墙</strong>
                                <span class="boundary-segment-label">~200 AU</span>
                            </div>
                            <div class="boundary-segment">
                                <span class="visual-cue">☄</span> <strong>奥尔特云</strong>
                                <span class="boundary-segment-label">3,000 - 100,000 AU</span>
                            </div>
                            <div class="boundary-segment">
                                <span class="visual-cue">♁</span> <strong>引力边界</strong>
                                <span class="boundary-segment-label">~100,000 AU</span>
                            </div>
                        </div>
                    </div>
                    <p class="mt-6 text-base text-slate-400 text-center">这是一个简化的太阳系多层次边界图，展示了从内行星轨道到遥远引力边界的不同区域。每个区域都有其独特的特征和科学研究价值。</p>
                    <h3 class="text-2xl font-semibold text-blue-400 mb-6 mt-10">交互式3D太阳系模型</h3>
                    <canvas id="solarSystem3DCanvas" class="three-d-canvas"></canvas>
                    <p class="mt-4 text-base text-slate-400 text-center">使用鼠标拖动旋转模型，滚轮缩放，感受太阳系的浩瀚。</p>
                </div>
            </div>
        </section>

        <section id="boundaries" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">探索边界：太阳系的多重界限</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    太阳系的边界远非一条简单的线，而是由行星轨道、柯伊伯带、日球层乃至遥远的奥尔特云构成的复杂结构。点击下方卡片，深入了解每个边界的特征与探测意义。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="boundary-card p-8 rounded-xl cursor-pointer" onclick="showBoundaryDetail('kuiper')">
                        <h3 class="text-2xl font-semibold mb-3">柯伊伯带 (Kuiper Belt)</h3>
                        <p class="text-base text-slate-400 mb-2"><strong>距离:</strong> 30 - 1,000 AU</p>
                        <p class="text-base text-slate-400 mb-2"><strong>组成:</strong> 冰、岩石、氨、甲烷；矮行星</p>
                        <p class="text-base text-slate-400"><strong>探测意义:</strong> 早期太阳系残余、行星形成研究</p>
                    </div>
                    <div class="boundary-card p-8 rounded-xl cursor-pointer" onclick="showBoundaryDetail('heliopause')">
                        <h3 class="text-2xl font-semibold mb-3">日球层顶 (Heliosphere)</h3>
                        <p class="text-base text-slate-400 mb-2"><strong>距离:</strong> 123 - 140 AU</p>
                        <p class="text-base text-slate-400 mb-2"><strong>特征:</strong> 太阳风与星际介质压力平衡处</p>
                        <p class="text-base text-slate-400"><strong>探测意义:</strong> 太阳磁场影响、宇宙射线防护</p>
                    </div>
                    <div class="boundary-card p-8 rounded-xl cursor-pointer" onclick="showBoundaryDetail('hotwall')">
                        <h3 class="text-2xl font-semibold mb-3">热墙 (Hot Wall)</h3>
                        <p class="text-base text-slate-400 mb-2"><strong>距离:</strong> ~200 AU</p>
                        <p class="text-base text-slate-400 mb-2"><strong>特征:</strong> 加热的星际氢原子区域</p>
                        <p class="text-base text-slate-400"><strong>探测意义:</strong> 星际介质与日球层相互作用</p>
                    </div>
                    <div class="boundary-card p-8 rounded-xl cursor-pointer" onclick="showBoundaryDetail('oort')">
                        <h3 class="text-2xl font-semibold mb-3">奥尔特云 (Oort Cloud)</h3>
                        <p class="text-base text-slate-400 mb-2"><strong>距离:</strong> 3,000 - 100,000 AU</p>
                        <p class="text-base text-slate-400 mb-2"><strong>组成:</strong> 冰质彗星状天体</p>
                        <p class="text-base text-slate-400"><strong>探测意义:</strong> 彗星起源、行星迁移历史</p>
                    </div>
                    <div class="boundary-card p-8 rounded-xl cursor-pointer" onclick="showBoundaryDetail('ism')">
                        <h3 class="text-2xl font-semibold mb-3">局部星际介质 (ISM)</h3>
                        <p class="text-base text-slate-400 mb-2"><strong>距离:</strong> >140 AU (日球层外)</p>
                        <p class="text-base text-slate-400 mb-2"><strong>组成:</strong> 氢、氦、尘埃、宇宙射线</p>
                        <p class="text-base text-slate-400"><strong>探测意义:</strong> 太阳系“空间天气”、银河系演化</p>
                    </div>
                </div>
                <div id="boundaryDetailModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center hidden z-50">
                    <div class="relative mx-auto p-8 border w-11/12 md:w-1/2 shadow-lg rounded-xl bg-gray-900">
                        <div class="mt-3 text-center">
                            <h3 id="modalTitle" class="text-3xl leading-6 font-medium text-blue-400 mb-4"></h3>
                            <div id="modalContent" class="mt-4 px-7 py-3 text-left text-slate-300">
                                </div>
                            <div class="items-center px-4 py-3">
                                <button id="closeModalButton" class="llm-button w-full">
                                    关闭
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="scaled-map" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8 text-center">比例尺太阳系地图</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    以成都理工大学校园为参照，直观感受太阳系天体的浩瀚距离。假设太阳直径1米，位于E1B215教室。<br>
                    <span class="text-base text-slate-400">（请注意：由于太阳系尺度的巨大差异，内行星在比例尺上会非常靠近太阳。）</span>
                </p>
                <div class="flex flex-col items-center p-8 space-y-8 bg-gray-800 rounded-xl border border-blue-700 shadow-xl">
                    <h1 class="text-3xl font-bold text-blue-400">成都理工大学比例尺太阳系</h1>
                    <p class="text-lg text-slate-400">1米直径太阳位于E1B215教室</p>
                    <div class="w-full overflow-x-auto pb-6">
                        <div class="relative h-3 bg-gradient-to-r from-yellow-400 via-blue-400 to-gray-300 rounded-full shadow-inner" style="width: 10000px;" id="solarSystemProgressBar">
                        </div>
                    </div>
                    <div id="planetCardsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full">
                        </div>
                </div>
            </div>

            <div id="planetDetailModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center hidden z-50">
                <div class="relative mx-auto p-8 border w-11/12 md:w-1/3 shadow-lg rounded-xl bg-gray-900">
                    <div class="mt-3 text-center">
                        <h3 id="planetModalTitle" class="text-3xl leading-6 font-medium text-blue-400 mb-4"></h3>
                        <div id="planetModalContent" class="mt-4 px-7 py-3 text-left planet-modal-content">
                            </div>
                        <div class="items-center px-4 py-3">
                            <button id="closePlanetModalButton" class="llm-button w-full">
                                关闭
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="mysteries" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">科学奥秘：揭示宇宙深层之谜</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    探索太阳系的边际，是为了解答关于宇宙起源、生命存在以及星系演化的基本问题。这些遥远区域是研究行星系统如何演化、生命如何起源的独特实验室。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">太阳系的起源与演化</h3>
                        <p class="text-lg text-slate-300 mb-4"><strong>柯伊伯带</strong>被认为是太阳系形成初期的“遗留物”，其冰冷天体是原始星子。研究它们的组成与轨道，有助于理解行星系统如何从原始星云中形成和演化。</p>
                        <p class="text-lg text-slate-300 mb-4"><strong>奥尔特云</strong>中的天体可能是太阳系内侧形成后被抛射出去的，是长周期彗星的来源。对它的探测将提供行星迁移过程的线索。</p>
                         <div class="mt-6 p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner">
                            <h4 class="text-xl font-semibold text-blue-300 mb-4">图示：日球层对宇宙射线的防护</h4>
                            <div class="text-center">
                                <span class="text-7xl block mb-4">☀️</span>
                                <div class="flex justify-around items-center my-4">
                                    <span class="text-4xl">🌍</span>
                                    <span class="text-5xl text-purple-400">🛡️</span>
                                    <span class="text-4xl">☄️</span>
                                </div>
                            </div>
                            <p class="text-base text-slate-400 mt-4 text-center">示意图：太阳风(☀️)形成日球层(🛡️)，保护内部行星(🌍)免受大部分银河宇宙射线(☄️)的侵袭。这是地球生命宜居的关键因素之一。</p>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">宇宙生命与宜居性</h3>
                        <p class="text-lg text-slate-300 mb-4"><strong>日球层</strong>是太阳系对抗银河宇宙射线的保护罩，对地球及其他行星的宜居性至关重要。</p>
                        <div class="chart-container mx-auto h-72 md:h-80 bg-gray-800 p-4 rounded-lg shadow-inner">
                            <canvas id="heliosphereProtectionChart"></canvas>
                        </div>
                        <p class="text-base text-slate-400 mt-4 text-center">图表（示意数据）：日球层对不同能量宇宙射线的过滤效果，展示其保护作用。</p>
                        <p class="text-lg text-slate-300 mt-6 mb-4">对外太阳系冰卫星（如木卫二欧罗巴）的探测发现，它们可能拥有冰下液态海洋，甚至具备原始生命的条件，拓展了我们对生命宜居区域的理解。</p>
                        <h3 class="text-3xl font-semibold text-blue-400 mt-8 mb-6">星际介质的直接探测</h3>
                        <p class="text-lg text-slate-300">日球层顶是太阳系与星际介质直接相互作用的区域。探测这一边界能帮助我们理解太阳系如何穿越银河系，以及太阳风与星际物质的相互作用。</p>
                    </div>
                </div>

                <div class="mt-12 p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-xl">
                    <h3 class="text-3xl font-semibold text-blue-400 mb-6 text-center">前代任务留下的未解之谜与下一代目标</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-2xl font-semibold text-blue-300 mb-4">现有空白与挑战：</h4>
                            <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                                <li><strong>旅行者号：</strong> 等离子体科学仪器失效，无法直接测量太阳风；未配备测量“拾取离子”（PUIs）的仪器，留下日球层如何抵抗星际风的谜团。其仪器套件未针对全面的星际介质测量进行优化。</li>
                                <li><strong>新视野号：</strong> 仅穿越了柯伊伯带的一小部分，关于天体总数、碰撞状态以及离散天体起源的问题仍未解决。</li>
                                <li><strong>IBEX/IMAP：</strong> 作为轨道器，提供的是遥感数据，而非深空原位测量。</li>
                                <li><strong>奥尔特云：</strong> 形成、演化和确切组成在很大程度上仍停留在理论层面，缺乏直接观测数据。</li>
                                <li><strong>星际介质：</strong> 其组成和特性直接影响日球层的形状、大小和保护能力，但缺乏详细的原位测量。</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-2xl font-semibold text-blue-300 mb-4">下一代探测器的主要科学目标：</h4>
                            <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                                <li><strong>表征日球层：</strong> 确定其真实全球形状和大小，理解太阳风与星际介质的相互作用，研究粒子加速机制，并测量“拾取离子”。</li>
                                <li><strong>星际介质原位分析：</strong> 表征局部星际介质的组成和性质，研究磁场相互作用，探测并表征星际尘埃。</li>
                                <li><strong>柯伊伯带与奥尔特云：</strong> 更好地理解柯伊伯带尘埃量和天体总数，绘制黄道尘埃云，搜索离散源周围的尘埃云，确定柯伊伯带尘埃组成，调查尘埃转换区域，并解决奥尔特云的形成与演化之谜。</li>
                                <li><strong>粒子加速与辐射环境：</strong> 量化深空中，特别是日球层之外的银河宇宙射线（GCRs）和太阳粒子事件（SPEs）的通量和能量水平。</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="earth-importance" class="pt-16 -mt-16 mb-16">
            <div class="card text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8">深空探索对地球的重要性</h2>
                <p class="text-xl text-slate-300 mb-10 max-w-4xl mx-auto">
                    深空探测不仅是探索未知，更是为了更好地理解和保护我们赖以生存的地球。对太阳系边缘环境的研究，帮助我们了解宇宙射线、太阳活动对地球生态的影响。
                </p>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-gray-800 rounded-xl shadow-xl text-left border border-blue-700">
                        <thead class="bg-blue-900">
                            <tr>
                                <th class="py-4 px-6 text-base font-semibold text-blue-300 uppercase tracking-wider rounded-tl-xl">重要性方面</th>
                                <th class="py-4 px-6 text-base font-semibold text-blue-300 uppercase tracking-wider rounded-tr-xl">简要说明</th>
                            </tr>
                        </thead>
                        <tbody id="importanceTableBody">
                            </tbody>
                    </table>
                </div>
                <p class="mt-6 text-base text-slate-400 text-center">
                    点击表格行查看更多详细信息。
                </p>
            </div>
            <div id="importanceDetailModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center hidden z-50">
                <div class="relative mx-auto p-8 border w-11/12 md:w-1/2 shadow-lg rounded-xl bg-gray-900">
                    <div class="mt-3 text-center">
                        <h3 id="importanceModalTitle" class="text-3xl leading-6 font-medium text-blue-400 mb-4"></h3>
                        <div id="importanceModalContent" class="mt-4 px-7 py-3 text-left text-slate-300"></div>
                        <div class="items-center px-4 py-3">
                            <button id="closeImportanceModalButton" class="llm-button w-full">
                                关闭
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="qa" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8 text-center">✨ 知识问答</h2>
                <p class="text-xl text-slate-300 mb-6 text-center max-w-4xl mx-auto">
                    对太阳系边际探测有任何疑问？在此提问，获取由AI模型提供的简洁答案！
                </p>
                <textarea id="qaInput" class="llm-textarea mb-6" rows="4" placeholder="例如：旅行者号是如何进入星际空间的？日球层顶是什么？"></textarea>
                <button id="askQuestionBtn" class="llm-button mx-auto">
                    <span id="qaSpinner" class="loading-spinner hidden"></span>
                    <span id="qaButtonText">提问</span>
                </button>
                <div id="qaOutput" class="mt-8 p-6 bg-gray-800 rounded-xl border border-blue-700 text-slate-300 min-h-[100px] shadow-inner">
                    <p class="text-slate-400 text-center">答案将显示在此处。</p>
                </div>
            </div>
        </section>

        <section id="technology" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">技术之巅：突破深空探索的极限</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    深空探索的宏伟目标伴随着通信、能源、导航和航天器生存等方面的严峻技术挑战。了解这些挑战以及科学家们如何突破极限。
                </p>
                <div class="mb-8 flex justify-center flex-wrap" id="techTabsContainer">
                    <button class="tab-button active" data-tab="communication">通信与数据</button>
                    <button class="tab-button" data-tab="energy">长寿命能源</button>
                    <button class="tab-button" data-tab="survival">极端环境生存</button>
                    <button class="tab-button" data-tab="navigation">导航与自主</button>
                    <button class="tab-button" data-tab="payloads">科学载荷与小型化</button>
                </div>

                <div id="techTabContent">
                    <div class="tab-content active p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner">
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">超远距离通信与数据传输</h3>
                        <p class="text-lg text-slate-300 mb-4">随着距离增加，信号衰减、延迟和带宽限制成为主要障碍。例如，新视野号从冥王星回传数据速率仅1-2 kbps，信号延迟数小时。</p>
                        <p class="text-lg text-slate-300 mb-3"><strong>解决方案与原理：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>光学通信（激光）：：</strong> 利用激光束进行数据传输。相比传统无线电波，激光的波长更短，频率更高，这意味着在相同时间内可以传输更多的数据，数据速率可提高10-100倍。激光束的扩散性也更小，能量更集中，有助于信号在长距离传输中保持强度。例如，DSOC项目旨在显著提升通信性能和效率。</li>
                            <li><strong>深空网络（DSN）与分布式容错网络（DTN）：：：</strong> DSN是由全球分布的巨型地面天线（如直径70米）组成的网络，用于接收和发送深空探测器信号。DTN则是一种“存储-转发”网络协议，旨在构建“太阳系互联网”，允许数据包在间歇性连接和长时间延迟下自动传输，无需实时连接。</li>
                            <li><strong>高精度时间同步技术：：：</strong> 通过原子钟和先进的算法，实现皮秒级的时间同步精度，有效补偿光速延迟、相对论效应和大气扰动带来的通信误差，确保数据传输的准确性。</li>
                            <li><strong>纠错码：</strong> 使用卷积码、Turbo码和低密度奇偶校验码等技术，确保在信号微弱和干扰严重的情况下，数据传输的完整性。</li>
                        </ul>
                    </div>
                    <div class="tab-content hidden p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-tab-content="energy">
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">长寿命能源系统</h3>
                        <p class="text-lg text-slate-300 mb-4">在远离太阳的区域，太阳能效率低下。放射性同位素热电发生器（RTG）是首选，但面临功率衰减和燃料供应问题。</p>
                        <p class="text-lg text-slate-300 mb-3"><strong>工作原理与未来方向：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>放射性同位素热电发生器（RTG）：：</strong> 利用放射性同位素（如钚-238）衰变产生的热量，通过温差电效应（塞贝克效应）直接转化为电能。RTG结构简单，可靠性高，寿命长，但能量转换效率相对较低，且功率会随时间衰减（例如，新视野号RTG每年衰减约3.2瓦）。钚-238供应有限是其主要挑战。</li>
                            <li><strong>斯特林放射性同位素发生器（SRG）：：：</strong> 基于斯特林循环的外部燃烧发动机，利用放射性同位素产生的热量驱动活塞运动，再由线性发电机将机械能转化为电能。SRG的能量转换效率远高于传统RTG（可达RTG的四倍），能从相同燃料中产生更多电能，从而延长任务寿命或支持更多高功耗仪器。</li>
                            <li><strong>核热推进（NTP）：：：</strong> 通过核反应堆加热液态推进剂（通常是液氢），使其膨胀成高温高压气体并高速喷出，产生巨大推力。其原理类似于化学火箭，但能量密度更高，比冲（衡量推进效率的指标）是化学火箭的两倍，能显著缩短深空旅行时间。</li>
                            <li><strong>核电推进（NEP）：：：：</strong> 核反应堆发电，电力用于驱动电推力器（如离子推力器）。电推力器通过电离惰性气体（如氙）并用电磁场加速离子产生推力。NEP的比冲极高，虽然推力较小，但能长时间持续加速，使得航天器能以极高的速度抵达遥远目的地，减少燃料携带量并实现更高的最终速度。</li>
                            <li><strong>小型裂变电源系统 (FPS)：</strong> 对于超过100千瓦的功率需求，FPS比RTGs更具成本优势。设计为冷发射并在轨道上启动反应堆，最大限度地降低放射性危害。</li>
                            <li><strong>太阳帆与定向能推进：</strong> 太阳帆通过利用太阳光压的动量来加速航天器，无需推进剂。定向能推进（激光帆）则涉及使用强大的地面或轨道激光来推动航天器，理论上可达到光速的40-80%。</li>
                        </ul>
                    </div>
                    <div class="tab-content hidden p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-tab-content="survival">
                        <h3 class="3xl font-semibold text-blue-400 mb-6">极端环境下的航天器生存</h3>
                        <p class="text-lg text-slate-300 mb-4">深空环境面临极端温度变化、高能宇宙射线和微流星体撞击的威胁。</p>
                        <p class="text-lg text-slate-300 mb-3"><strong>应对策略与原理：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>结构完整性与材料选择：</strong>
                                <ul class="list-circle list-inside ml-6 space-y-2">
                                    <li><strong>先进合金：</strong> 采用轻质、坚固且耐辐射的铝合金（如“交叉”铝合金）、钛合金（如Ti-6Al-4V）和镍基高温合金，以应对真空、极端冷热循环、紫外线辐射、带电粒子辐射和微陨石撞击。</li>
                                    <li><strong>长期降解：</strong> 应对真空导致的材料“放气”和摩擦磨损；辐射引起的材料硬化或软化；以及微陨石撞击造成的表面侵蚀、穿孔和剥落。</li>
                                </ul>
                            </li>
                            <li><strong>热控系统（TCS）：</strong>
                                <ul class="list-circle list-inside ml-6 space-y-2">
                                    <li><strong>被动热控：</strong> 多层绝缘（MLI）毯用于反射太阳光并保留内部热量，涂层和光学太阳反射器（OSRs）改变表面热光学特性，百叶窗调节热辐射。</li>
                                    <li><strong>主动热控：</strong> 电加热器防止关键系统结冰，流体回路将热量传输到散热器，放射性同位素加热单元（RHUs）提供局部热量，热管高效传热，热电冷却器移走热量。RTGs产生的废热也用于维持航天器温度。</li>
                                </ul>
                            </li>
                            <li><strong>辐射硬化设计保护电子设备：：：：</strong> 包括采用特殊制造工艺（如SOI技术）使芯片对辐射不敏感，以及在关键电子元件外部增加物理屏蔽层（如铅或铝）。同时，软件层面会集成错误检测与纠正（EDAC）机制，自动识别并修复由辐射引起的内存或数据错误。</li>
                            <li><strong>任务规划规避已知流星群：：：</strong> 通过对流星体环境的建模和实时监测，规划航天器轨道和姿态，尽量避免穿越高密度微流星体区域。对于不可避免的撞击，航天器关键部件会采用双层或多层结构设计，以分散撞击能量，降低穿透风险。</li>
                        </ul>
                    </div>
                    <div class="tab-content hidden p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-tab-content="navigation">
                        <h3 class="3xl font-semibold text-blue-400 mb-6">高精度导航与自主运行</h3>
                        <p class="text-lg text-slate-300 mb-4">传统地球基导航方法在远距离精度下降。通信延迟要求航天器具备高度自主性。</p>
                        <p class="text-lg text-slate-300 mb-3"><strong>创新方法与系统：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>X射线脉冲星导航（XNAV）：：：</strong> 利用脉冲星发出的高度规律的X射线脉冲信号作为宇宙中的“灯塔”。通过测量来自多个脉冲星信号到达航天器的时间差，可以精确计算航天器的位置和速度，实现自主导航，尤其适用于远离地球的深空环境。</li>
                            <li><strong>天体光谱测速法：：：</strong> 通过分析深空天体（如遥远恒星或星系）光谱中的多普勒频移，来精确测量航天器相对于这些天体的径向速度。结合其他导航数据，可以提高航天器在深空中的速度测量精度。</li>
                            <li><strong>自主故障检测与纠正系统：：：</strong> 航天器搭载先进的机载计算机和人工智能算法，能够实时监控自身健康状况和性能。一旦检测到异常或故障，系统能自动诊断问题，并根据预设规则或学习到的经验采取纠正措施（如切换到冗余系统、重启模块），无需等待地球指令。</li>
                            <li><strong>人工智能与机器学习辅助决策：：：：</strong> 利用AI模型分析海量传感器数据，识别模式，预测未来状态，并辅助航天器在复杂或不确定环境下做出最佳决策，例如优化轨道、调整姿态以规避障碍，或在科学观测中自主选择最有价值的目标。</li>
                        </ul>
                    </div>
                    <div class="tab-content hidden p-6 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-tab-content="payloads">
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">科学载荷与小型化</h3>
                        <p class="text-lg text-slate-300 mb-4">深空任务的科学广度直接取决于其载荷的质量和功率预算。通过微电子学和材料科学的进步实现科学仪器的小型化，是下一代探测器的关键推动力。</p>
                        <p class="text-lg text-slate-300 mb-3"><strong>边界探索的关键仪器：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>等离子体探测器：</strong> 测量等离子体的密度、组成、温度、速度，以及太阳风的相互作用。</li>
                            <li><strong>磁力计：</strong> 探测和测量磁场的强度和方向，对研究日球层和星际磁场至关重要。</li>
                            <li><strong>宇宙射线子系统（CRS）和低能带电粒子（LECP）探测器：</strong> 测量来自行星磁层和太阳系外源粒子的组成、能量和角分布。</li>
                            <li><strong>尘埃探测器：</strong> 测量尘埃粒子的数量、速度、质量、电荷、飞行方向和组成，如星际尘埃分析仪（IDA）。</li>
                            <li><strong>光谱仪：</strong> 通过吸收/发射光谱法分析物质组成，例如紫外成像光谱仪（UVIS）、可见光和红外测绘光谱仪（VIMS）、复合红外光谱仪（CIRS）和离子与中性粒子质谱仪（INMS）。</li>
                            <li><strong>成像仪：</strong> 用于飞越成像，例如成像科学子系统（ISS）、全景相机（Pancam）和显微成像仪。</li>
                            <li><strong>高能中性原子（ENA）相机：</strong> 用于对日球层边界相互作用进行成像。</li>
                            <li><strong>中性粒子质谱仪（NMS）：</strong> 用于分析中性粒子组成。</li>
                            <li><strong>莱曼-阿尔法光谱仪（LYA）：</strong> 用于探测氢原子分布。</li>
                        </ul>
                        <p class="text-lg text-slate-300 mt-6 mb-3"><strong>小型化趋势：：</strong></p>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li>微电子学、材料科学和制造技术的进步使得更小、功能更强的卫星和仪器成为可能。</li>
                            <li>小型化仪器可减少质量和功耗，为其他仪器腾出空间或降低发射成本，从而最大限度地提高单次任务的科学回报。</li>
                            <li>未来概念甚至包括“晶圆级”航天器，集成光学通信、成像、推进器、电源和传感器。</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="nuclear-power-principles" class="mb-16">
            <div class="card text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8">⚛️ 未来动力系统原理：互动式学习</h2>
                <p class="text-xl text-slate-300 mb-10 max-w-4xl mx-auto">
                    深空探测需要强大而持久的能源与推进系统。在这里，我们将互动式地探索四种关键的核动力与推进技术的基本原理、优势和挑战，它们是人类迈向星际空间的基石。
                </p>

                <div class="flex flex-wrap justify-center mb-8" id="systemTabs">
                    <button class="tab-button active" data-system="RTG">放射性同位素热电发生器 (RTG)</button>
                    <button class="tab-button" data-system="SRG">斯特林放射性同位素发生器 (SRG)</button>
                    <button class="tab-button" data-system="NTP">核热推进 (NTP)</button>
                    <button class="tab-button" data-system="NEP">核电推进 (NEP)</button>
                </div>

                <div id="systemContent">
                    <div class="content-box active p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-content="RTG">
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">放射性同位素热电发生器 (RTG)</h3>
                        <div class="visual-representation">
                            ☢️ ➡️ 🔥 ➡️ ⚡
                        </div>
                        <canvas id="rtg3DCanvas" class="nuclear-power-canvas"></canvas>
                        <p class="text-lg text-slate-300 mb-4"><strong>基本原理：：</strong> RTG利用放射性同位素（如钚-238）衰变过程中释放的热量。这些热量通过温差电材料（如热电偶）直接转化为电能，这一过程称为塞贝克效应。</p>
                        <p class="key-points text-lg text-slate-300 mb-3"><strong>优势：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>长寿命：</strong> 只要放射性同位素持续衰变，就能提供稳定电力，任务寿命可达数十年（如旅行者号）。</li>
                            <li><strong>高可靠性：：</strong> 无需移动部件，结构简单，故障率低。</li>
                            <li><strong>环境适应性强：：：</strong> 不依赖阳光，可在远离太阳的深空、行星表面或大气层中运行。</li>
                        </ul>
                        <p class="disadvantages text-lg text-slate-300 mb-3"><strong>挑战/局限：：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>功率有限且衰减：：</strong> 功率输出相对较低，且会随同位素衰变而逐年下降（例如，新视野号RTG每年衰减约3.2瓦）。</li>
                            <li><strong>燃料稀缺与成本：：：</strong> 钚-238等燃料生产复杂、成本高昂且供应有限。</li>
                            <li><strong>放射性风险：：：</strong> 存在放射性物质，需要严格的安全措施。</li>
                        </ul>
                    </div>

                    <div class="content-box hidden p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-content="SRG">
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">斯特林放射性同位素发生器 (SRG)</h3>
                        <div class="visual-representation">
                            ☢️ ➡️ 🔥 ➡️ ⚙️ ➡️ ⚡
                        </div>
                        <canvas id="srg3DCanvas" class="nuclear-power-canvas"></canvas>
                        <p class="text-lg text-slate-300 mb-4"><strong>基本原理：：</strong> SRG同样利用放射性同位素衰变的热量。但它通过斯特林发动机（一种外部燃烧发动机）将热能转化为机械能，再由线性发电机将机械能转化为电能。斯特林循环通过加热和冷却气体来驱动活塞运动。</p>
                        <p class="key-points text-lg text-slate-300 mb-3"><strong>优势：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>高效率：：</strong> 能量转换效率远高于传统RTG，能从相同燃料中产生更多电能（约RTG的四倍）。</li>
                            <li><strong>延长任务寿命/支持更多仪器：：：</strong> 更高的效率意味着更长的任务持续时间或支持更多高功耗科学仪器。</li>
                            <li><strong>振动小：：：</strong> 线性斯特林发动机振动小，对精密仪器影响小。</li>
                        </ul>
                        <p class="disadvantages text-lg text-slate-300 mb-3"><strong>挑战/局限：：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>技术复杂性：：：</strong> 包含移动部件，结构比RTG复杂，对制造精度要求高。</li>
                            <li><strong>可靠性验证：：：</strong> 作为相对较新的技术，需要更多空间任务验证其长期可靠性。</li>
                            <li><strong>放射性风险：：：：</strong> 同样涉及放射性物质。</li>
                        </ul>
                    </div>

                    <div class="content-box hidden p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-content="NTP">
                        <h3>核热推进 (NTP)</h3>
                        <div class="visual-representation">
                            ⚛️ ➡️ � ➕ 💧 ➡️ 💨 ➡️ 🚀
                        </div>
                        <canvas id="ntp3DCanvas" class="nuclear-power-canvas"></canvas>
                        <p class="text-lg text-slate-300 mb-4"><strong>基本原理：：</strong> NTP利用核反应堆产生的高温加热液态推进剂（通常是液氢）。被加热的推进剂膨胀成高温高压气体，然后通过喷管高速喷出，产生巨大推力，推动航天器前进。</p>
                        <p class="key-points text-lg text-slate-300 mb-3"><strong>优势：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>高比冲：：：</strong> 比冲（衡量推进效率的指标）是化学火箭的两倍，意味着相同燃料可产生更长时间的推力或达到更高速度。</li>
                            <li><strong>缩短旅行时间：：：</strong> 能显著缩短深空旅行时间，例如将火星任务时间从数月缩短至数周。</li>
                            <li><strong>高推力：：：</strong> 相比电推进，NTP能提供更大的推力，适合快速离轨和行星际转移。</li>
                        </ul>
                        <p class="disadvantages text-lg text-slate-300 mb-3"><strong>挑战/局限：：：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>技术复杂性：：：：</strong> 核反应堆设计、高温材料和推进剂管理复杂。</li>
                            <li><strong>安全性：：：：</strong> 涉及核反应堆的发射和运行安全，需要严格的防护措施。</li>
                            <li><strong>燃料储存：：：：：</strong> 液氢需要极低温储存，增加了系统复杂性和质量。</li>
                        </ul>
                    </div>

                    <div class="content-box hidden p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-inner" data-content="NEP">
                        <h3>核电推进 (NEP)</h3>
                        <div class="visual-representation">
                            ⚛️ ➡️ ⚡ ➕ 💨 ➡️ ✨ ➡️ 🚀
                        </div>
                        <canvas id="nep3DCanvas" class="nuclear-power-canvas"></canvas>
                        <p class="text-lg text-slate-300 mb-4"><strong>基本原理：：</strong> NEP系统使用核反应堆发电，然后将电力用于驱动电推力器（如离子推力器）。电推力器通过电离惰性气体（如氙）并用电磁场加速离子，产生微小但持续的推力。</p>
                        <p class="key-points text-lg text-slate-300 mb-3"><strong>优势：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>极高比冲：：：</strong> 比冲远超化学推进和核热推进，燃料效率极高，显著减少所需推进剂质量。</li>
                            <li><strong>高最终速度：：：</strong> 能够长时间持续加速，使得航天器能以极高的速度抵达遥远目的地。</li>
                            <li><strong>多任务能力：：：</strong> 强大的电力可同时支持推进和高功耗科学仪器。</li>
                        </ul>
                        <p class="disadvantages text-lg text-slate-300 mb-3"><strong>挑战/局限：：：：</strong></p>
                        <ul class="text-left list-disc list-inside text-slate-300 space-y-2 pl-4">
                            <li><strong>推力小：：：：</strong> 推力非常小，不适合快速离轨或大质量航天器。需要长时间才能达到高速度。</li>
                            <li><strong>反应堆与电力系统：：：：</strong> 需要高效、紧凑且可靠的核反应堆和电力转换系统。</li>
                            <li><strong>安全性：：：：：</strong> 同样涉及核反应堆的发射和运行安全。</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        <section id="pioneers" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">先行者之路：旅行者与新视野号</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    旅行者号和新视野号是深空探索的丰碑。它们不仅取得了辉煌的科学成就，其克服挑战的经验也为未来任务提供了宝贵启示。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">旅行者号：星际信使</h3>
                        <p class="text-lg text-slate-300 mb-3">1977年发射，首次飞越所有四颗外行星，并率先进入星际空间。</p>
                        <p class="text-lg text-slate-300 mb-2"><strong>运行寿命:</strong> <span id="voyagerLifespan" class="font-bold text-blue-300">45+</span> 年</p>
                        <p class="text-lg text-slate-300"><strong>关键成就:</strong> 发现木卫一火山、木卫二海洋潜力，直接测量星际介质。</p>
                        <ul class="list-disc list-inside text-slate-300 space-y-2 mt-4 pl-4">
                            <li><strong>穿越日球层顶：：</strong> 旅行者1号于2012年，旅行者2号于2018年相继穿越日球层顶，首次直接测量了星际空间的环境。</li>
                            <li><strong>星际磁场：：：</strong> 探测到磁场强度显著增加，且方向与日球层内部磁场不同，证实了进入星际空间。</li>
                            <li><strong>宇宙射线：：：</strong> 银河宇宙射线（GCRs）强度急剧增加，而太阳系内部的太阳宇宙射线则几乎消失。</li>
                            <li><strong>星际等离子体：：：：</strong> 首次直接测量到星际等离子体的密度，发现其比日球层内部稀薄但温度更高。</li>
                            <li><strong>日球层形状：：：：：</strong> 通过对日球层顶内外粒子和磁场的测量，帮助科学家更好地理解日球层的真实形状和与星际介质的相互作用。</li>
                            <li><strong>克服挑战：</strong> 曾遭遇主推进器失效、备用系统堵塞和通信数据乱码等问题，但通过团队的创造性努力和冗余设计成功解决。</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">新视野号：柯伊伯带先锋</h3>
                        <p class="text-lg text-slate-300 mb-3">2006年发射，首次近距离探测冥王星和柯伊伯带天体阿罗科斯。</p>
                        <p class="text-lg text-slate-300 mb-2"><strong>冥王星数据回传:</strong> <span class="font-bold text-blue-300">15+</span> 个月</p>
                        <p class="text-lg text-slate-300"><strong>关键成就:</strong> 揭示冥王星复杂地貌，探测最遥远天体。</p>
                        <ul class="list-disc list-inside text-slate-300 space-y-2 mt-4 pl-4">
                            <li><strong>飞越冥王星：</strong> 2015年首次近距离飞越冥王星及其五颗卫星，揭示了其复杂的表面地貌和直径。</li>
                            <li><strong>飞越阿罗科斯：</strong> 2019年飞越了阿罗科斯（2014 MU69），提供了原始星子的宝贵数据。</li>
                            <li><strong>任务设计与故障应对：</strong> 利用木星引力辅助缩短旅行时间。在冥王星飞越前曾遭遇计算机异常，但通过冗余系统和团队快速响应成功恢复。</li>
                            <li><strong>数据回传挑战：</strong> 由于距离遥远和传输速率限制，冥王星的6.25GB数据回传耗时超过15个月。</li>
                        </ul>
                    </div>
                </div>
                <div class="mt-10">
                    <h3 class="text-3xl font-semibold text-blue-400 mb-8 text-center">任务里程碑时间线</h3>
                    <div class="timeline max-w-3xl mx-auto">
                        <div class="timeline-item">
                            <div class="timeline-icon">🚀</div>
                            <h4 class="font-semibold text-blue-300">1977: 旅行者1号与2号发射</h4>
                            <p class="text-base text-slate-400">开启对外太阳系巨行星的首次详细探测。</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon">🪐</div>
                            <h4 class="font-semibold text-blue-300">1979-1989: 旅行者号飞越木、土、天、海</h4>
                            <p class="text-base text-slate-400">揭示了行星系统众多新特征。</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon">🚀</div>
                            <h4 class="font-semibold text-blue-300">2006: 新视野号发射</h4>
                            <p class="text-base text-slate-400">目标冥王星和柯伊伯带。</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon">🌌</div>
                            <h4 class="font-semibold text-blue-300">2012 & 2018: 旅行者1号与2号进入星际空间</h4>
                            <p class="text-base text-slate-400">成为首批飞出日球层顶的人造物体。</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon">🧊</div>
                            <h4 class="font-semibold text-blue-300">2015: 新视野号飞越冥王星</h4>
                            <p class="text-base text-slate-400">揭示了冥王星的复杂地质。</p>
                        </div>
                         <div class="timeline-item">
                            <div class="timeline-icon">☄️</div>
                            <h4 class="font-semibold text-blue-300">2019: 新视野号飞越阿罗科斯</h4>
                            <p class="text-base text-slate-400">近距离探测最遥远的原始星子。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="voyager-special" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">🚀 旅行者号专题：星际探索的传奇</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    深入了解旅行者1号和2号这两艘人类历史上最伟大的探测器。点击时间轴上的事件，探索它们的里程碑和开创性科学发现。
                </p>
                <div class="max-w-3xl mx-auto">
                    <h3 class="text-3xl font-semibold text-blue-400 mb-8 text-center">旅行者号任务时间轴与发现</h3>
                    <div class="timeline" id="voyagerTimeline">
                        </div>
                    <div id="voyagerDetailArea" class="hidden">
                        <h3 id="voyagerDetailTitle"></h3>
                        <p id="voyagerDetailDescription"></p>
                        <div id="voyagerDetailDiscoveries">
                            <h4 class="font-semibold text-blue-300 mt-5 mb-3">主要科学发现：</h4>
                            <ul id="voyagerDiscoveriesList"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <section id="china-action" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">中国行动：迈向深空的步伐</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    中国在深空探测领域取得了举世瞩目的成就，这些探索不仅拓展了人类的认知边界，也为未来更遥远的太阳系边际探测奠定了坚实的技术和科学基础。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">月球与火星探测：深空技术基石</h3>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>嫦娥系列月球任务：：</strong> 成功实现了绕月探测、月球软着陆、巡视探测以及月球采样返回。这些任务积累了远距离测控通信、自主导航、长期能源保障等关键深空技术，为未来更远距离的探测提供了宝贵经验。</li>
                            <li><strong>天问一号火星任务：：：</strong> 一次性实现“绕、落、巡”三大目标，祝融号火星车开展巡视探测。火星任务对深空通信延迟、极端环境生存和自主运行提出了更高要求，其成功是中国深空探测能力的重要体现。</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">迈向太阳系边际的未来展望</h3>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>小行星探测：：</strong> 正在规划中的小行星探测任务，将进一步验证和发展深空自主导航、精确交会与伴飞等技术，这些对于未来探测柯伊伯带等小型天体至关重要。</li>
                            <li><strong>木星系探测：：：</strong> 对木星及其卫星的探测任务也在论证和规划中。木星系距离遥远，辐射环境复杂，对航天器的能源、通信和抗辐射能力提出严峻挑战，这些技术突破将直接服务于未来的太阳系边际探测。</li>
                            <li><strong>星际探测概念：：：：</strong> 中国科学家也正在积极探讨和论证更远期的星际探测任务概念，旨在深入日球层顶和星际空间，探索太阳系真正的边界。</li>
                        </ul>
                    </div>
                </div>
                <p class="text-lg text-slate-300 mt-8 text-center">
                    中国深空探测坚持自主创新与开放合作并重，积极推动国际交流与合作，共同应对深空探索的挑战，为构建人类命运共同体贡献力量。
                </p>
            </div>
        </section>

        <section id="future" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-10 text-center">未来征程：太阳系边际探测新纪元</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    基于现有成就，未来的深空任务将更加雄心勃勃，旨在深入星际介质，探索太阳系外围的更多未知，并可能带来关于宇宙基本性质和生命普遍性的突破性发现。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                    <div>
                        <h3 class="text-3xl font-semibold text-blue-400 mb-6">概念任务与前沿探测器</h3>
                        <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                            <li><strong>“星际探测器”计划:</strong> NASA正在考虑开发，旨在超越旅行者号，深入星际介质，从外部对日球层成像，预计需要50年或更长时间才能到达。</li>
                            <li><strong>“星际日球层顶探测器”（IHP）概念:</strong> 欧洲空间局（ESA）的类似概念，目标是在25年内到达200 AU，计划使用太阳帆或核电推进技术。</li>
                            <li><strong>彗星拦截器:</strong> 预计2029年发射，飞越奥尔特云彗星。</li>
                            <li><strong>天王星/海王星探测任务:</strong> 未来可能对冰巨行星进行专门探测。</li>
                            <li><strong>木星冰卫星探测器 (JUICE) / 欧罗巴快船:</strong> 正在进行中，研究木星冰卫星的宜居潜力。</li>
                        </ul>
                        <p class="text-lg text-slate-300 mt-6">未来的任务旨在提供对星际介质及其与日球层相互作用更全面的理解，超越仅仅的粒子计数，深入到详细的成分、磁场和动态过程。</p>
                    </div>
                    <div class="chart-container mx-auto h-80 bg-gray-800 p-4 rounded-lg shadow-inner">
                        <canvas id="futureProbeCapabilitiesChart"></canvas>
                    </div>
                </div>
                <p class="text-base text-slate-400 mt-4 text-center">雷达图（示意数据）：未来“星际探测器”概念与“旅行者号”在关键能力上的对比。</p>
                <p class="text-lg text-slate-300 mt-8">未来的探测器将配备更先进的科学仪器，例如IMAP仪器套件，能够测量高能中性原子、宇宙尘埃组成等，提供前所未有的详细数据。国际合作在这些复杂且耗资巨大的任务中也变得越来越重要。</p>
            </div>
        </section>

        <section id="design-probe" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8 text-center">🛠️ 设计你的太阳系边缘探测器</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    发挥你的想象力，从零开始设计一个属于你自己的太阳系边缘探测器！选择任务目标、动力系统、通信方式和科学仪器，看看你的设计能飞多远，发现什么！
                </p>

                <div class="design-step">
                    <h3>第一步：选择任务目标</h3>
                    <div class="space-y-4" id="missionGoalOptions">
                        <label class="component-option" data-type="mission" data-value="Kuiper Belt">
                            <input type="radio" name="missionGoal" value="Kuiper Belt">
                            <div class="component-info">
                                <strong>探索柯伊伯带</strong>
                                <p class="text-base text-slate-400">目标：近距离飞越柯伊伯带天体，研究其组成和起源。</p>
                                <div class="component-stats">预计距离: ~50 AU | 预计任务时长: 中等</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="mission" data-value="Oort Cloud">
                            <input type="radio" name="missionGoal" value="Oort Cloud">
                            <div class="component-info">
                                <strong>探测奥尔特云</strong>
                                <p class="text-base text-slate-400">目标：首次直接探测奥尔特云天体，寻找原始彗星。</p>
                                <div class="component-stats">预计距离: ~5,000 - 10,000 AU | 预计任务时长: 极长</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="mission" data-value="Interstellar Space">
                            <input type="radio" name="missionGoal" value="Interstellar Space">
                            <div class="component-info">
                                <strong>进入星际空间</strong>
                                <p class="text-base text-slate-400">目标：超越日球层顶，直接测量星际介质环境。</p>
                                <div class="component-stats">预计距离: >150 AU | 预计任务时长: 长</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="design-step">
                    <h3>第二步：选择动力系统</h3>
                    <div class="space-y-4" id="powerSystemOptions">
                        <label class="component-option" data-type="power" data-value="RTG">
                            <input type="radio" name="powerSystem" value="RTG">
                            <div class="component-info">
                                <strong>放射性同位素热电发生器 (RTG)</strong>
                                <p class="text-base text-slate-400">成熟可靠，寿命长，但功率有限且逐年衰减。</p>
                                <div class="component-stats">功率: 中 | 寿命: 长 | 成本: 中</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="power" data-value="SRG">
                            <input type="radio" name="powerSystem" value="SRG">
                            <div class="component-info">
                                <strong>斯特林放射性同位素发生器 (SRG)</strong>
                                <p class="text-base text-slate-400">比RTG更高效，相同燃料产生更多电能，但技术相对较新。</p>
                                <div class="component-stats">功率: 高 | 寿命: 长 | 成本: 较高</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="power" data-value="Small Nuclear Reactor">
                            <input type="radio" name="powerSystem" value="Small Nuclear Reactor">
                            <div class="component-info">
                                <strong>小型核反应堆</strong>
                                <p class="text-base text-slate-400">提供强大且持续的电力，支持高功耗仪器和通信，但复杂且成本高昂。</p>
                                <div class="component-stats">功率: 极高 | 寿命: 极长 | 成本:极高</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="design-step">
                    <h3>第三步：选择推进系统</h3>
                    <div class="space-y-4" id="propulsionSystemOptions">
                        <label class="component-option" data-type="propulsion" data-value="Chemical Propulsion">
                            <input type="radio" name="propulsionSystem" value="Chemical Propulsion">
                            <div class="component-info">
                                <strong>化学推进</strong>
                                <p class="text-base text-slate-400">推力大，适合短期加速和轨道修正，但燃料消耗快。</p>
                                <div class="component-stats">加速: 快 | 燃料效率: 低 | 成本: 中</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="propulsion" data-value="Ion Thruster">
                            <input type="radio" name="propulsionSystem" value="Ion Thruster">
                            <div class="component-info">
                                <strong>离子推力器</strong>
                                <p class="text-base text-slate-400">比冲高，燃料效率极高，适合长期缓慢加速以达到极高速度。</p>
                                <div class="component-stats">加速: 慢 | 燃料效率: 极高 | 成本: 较高</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="propulsion" data-value="Nuclear Thermal Propulsion">
                            <input type="radio" name="propulsionSystem" value="Nuclear Thermal Propulsion">
                            <div class="component-info">
                                <strong>核热推进 (NTP)</strong>
                                <p class="text-base text-slate-400">高推力，高比冲，能显著缩短深空旅行时间，但技术复杂。</p>
                                <div class="component-stats">加速: 极快 | 燃料效率: 高 | 成本: 极高</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="design-step">
                    <h3>第四步：选择通信系统</h3>
                    <div class="space-y-4" id="communicationSystemOptions">
                        <label class="component-option" data-type="communication" data-value="Radio (DSN)">
                            <input type="radio" name="communicationSystem" value="Radio (DSN)">
                            <div class="component-info">
                                <strong>无线电 (深空网络)</strong>
                                <p class="text-base text-slate-400">成熟可靠，但数据速率随距离衰减快，延迟长。</p>
                                <div class="component-stats">数据速率: 低 | 延迟: 长 | 成本: 中</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="communication" data-value="Optical Communication">
                            <input type="radio" name="communicationSystem" value="Optical Communication">
                            <div class="component-info">
                                <strong>光学通信 (激光)</strong>
                                <p class="text-base text-slate-400">数据速率极高，但需要高精度指向和晴朗天气，技术较新。</p>
                                <div class="component-stats">数据速率: 极高 | 延迟: 长 | 成本: 较高</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="design-step">
                    <h3>第五步：选择科学仪器</h3>
                    <div class="space-y-4" id="instrumentOptions">
                        <label class="component-option" data-type="instrument" data-value="Plasma Spectrometer">
                            <input type="radio" name="instrument" value="Plasma Spectrometer">
                            <div class="component-info">
                                <strong>等离子体光谱仪</strong>
                                <p class="text-base text-slate-400">测量带电粒子（如太阳风、星际等离子体）的能量和组成。</p>
                                <div class="component-stats">科学价值: 高 | 功耗: 中 | 质量: 中</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="instrument" data-value="Magnetometer">
                            <input type="radio" name="instrument" value="Magnetometer">
                            <div class="component-info">
                                <strong>磁力计</strong>
                                <p class="text-base text-slate-400">测量磁场强度和方向，对研究日球层和星际磁场至关重要。</p>
                                <div class="component-stats">科学价值: 高 | 功耗: 低 | 质量: 低</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="instrument" data-value="Dust Analyzer">
                            <input type="radio" name="instrument" value="Dust Analyzer">
                            <div class="component-info">
                                <strong>尘埃分析仪</strong>
                                <p class="text-base text-slate-400">分析星际尘埃的组成、速度和质量，揭示星际物质起源。</p>
                                <div class="component-stats">科学价值: 高 | 功耗: 中 | 质量: 中</div>
                            </div>
                        </label>
                        <label class="component-option" data-type="instrument" data-value="Imaging System">
                            <input type="radio" name="instrument" value="Imaging System">
                            <div class="component-info">
                                <strong>成像系统</strong>
                                <p class="text-base text-slate-400">拍摄天体图像，提供视觉信息，但数据量大。</p>
                                <div class="component-stats">科学价值: 极高 | 功耗: 高 | 质量: 高</div>
                            </div>
                        </label>
                    </div>
                </div>

                <button id="generateProbeDesignBtn" class="llm-button mx-auto mt-10">
                    <span id="designSpinner" class="loading-spinner hidden"></span>
                    <span id="designButtonText">生成探测器设计</span>
                </button>

                <div id="probeSummary" class="hidden">
                    <h3 class="text-3xl font-semibold mb-6">你的探测器设计：</h3>
                    <p class="mb-3 text-lg"><strong>任务目标：</strong> <span id="summaryMissionGoal"></span></p>
                    <p class="mb-3 text-lg"><strong>动力系统：：</strong> <span id="summaryPowerSystem"></span></p>
                    <p class="mb-3 text-lg"><strong>推进系统：</strong> <span id="summaryPropulsionSystem"></span></p>
                    <p class="mb-3 text-lg"><strong>通信系统：：</strong> <span id="summaryCommunicationSystem"></span></p>
                    <p class="mb-3 text-lg"><strong>科学仪器：：</strong> <span id="summaryInstrument"></span></p>
                    <div id="totalScore" class="mt-6">总分：<span id="scoreValue">0</span></div>
                    <div id="designFeedback" class="mt-6">
                        <p class="text-lg"><strong>设计评估：：</strong></p>
                        <p id="feedbackContent" class="mt-3 text-lg"></p>
                    </div>
                </div>
            </div>
        </section>

        <section id="probe-simulation" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8 text-center">🎮 自主探测器模拟：星际之旅</h2>
                <p class="text-xl text-slate-300 mb-10 text-center max-w-4xl mx-auto">
                    你是一个自主探测器，被派往太阳系边缘执行任务。你的目标是尽可能深入星际空间，收集科学数据，并克服各种挑战。祝你好运，星际旅行者！
                </p>

                <div class="simulation-status">
                    <p><strong>当前距离：</strong> <span id="simDistance">100</span> AU</p>
                    <p><strong>能量剩余：：</strong> <span id="simPower">100</span> %</p>
                    <p><strong>健康状况：：</strong> <span id="simHealth">100</span> %</p>
                    <p><strong>数据收集：：</strong> <span id="simData">0</span> 单位</p>
                    <p class="col-span-2"><strong>任务得分：：</strong> <span id="simMissionScore">0</span> 分</p>
                </div>

                <div id="simulationEventDisplay" class="simulation-event hidden">
                    <p><strong>事件：</strong> <span id="simEventName"></span></p>
                    <p><span id="simEventDescription"></span></p>
                    <div id="simulationChoices" class="mt-5 simulation-choices">
                        </div>
                </div>

                <div id="simulationResultDisplay" class="simulation-result hidden">
                    <p><strong>结果：：</strong> <span id="simResultDetails"></span></p>
                </div>

                <div id="simulationEndDisplay" class="hidden">
                    </div>

                <div class="flex justify-center mt-10 space-x-6">
                    <button id="startSimulationBtn" class="llm-button">开始模拟</button>
                    <button id="nextEventBtn" class="llm-button hidden">下一个事件</button>
                    <button id="resetSimulationBtn" class="llm-button hidden bg-red-500 hover:bg-red-600">重新开始</button>
                </div>

                <div class="simulation-log mt-8">
                    <h3 class="font-semibold text-blue-400 mb-4">任务日志：</h3>
                    <div id="simLogContent">
                        <p class="text-slate-400">等待模拟开始...</p>
                    </div>
                </div>
            </div>
        </section>
        <section id="mission-inspiration" class="pt-16 -mt-16 mb-16">
            <div class="card">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8 text-center">✨ 任务灵感</h2>
                <p class="text-xl text-slate-300 mb-6 text-center max-w-4xl mx-auto">
                    输入一个简单的任务想法（例如：探测奥尔特云中的冰质天体），让AI为您构想一个未来任务！
                </p>
                <textarea id="missionConceptInput" class="llm-textarea mb-6" rows="3" placeholder="例如：探测奥尔特云中的冰质天体"></textarea>
                <button id="generateMissionConceptBtn" class="llm-button mx-auto">
                    <span id="missionSpinner" class="loading-spinner hidden"></span>
                    <span id="missionButtonText">生成构想</span>
                </button>
                <div id="missionConceptOutput" class="mt-8 p-6 bg-gray-800 rounded-xl border border-blue-700 text-slate-300 min-h-[150px] shadow-inner">
                    <p class="text-slate-400 text-center">任务构想将显示在此处。</p>
                </div>
            </div>
        </section>

        <section id="fact-generator" class="pt-16 -mt-16 mb-16">
            <div class="card text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8">💡 趣味事实</h2>
                <p class="text-xl text-slate-300 mb-6 max-w-4xl mx-auto">
                    点击按钮，获取一个关于太阳系边际探测的随机趣味事实！
                </p>
                <button id="generateFactBtn" class="llm-button mx-auto">
                    <span id="factSpinner" class="loading-spinner hidden"></span>
                    <span id="factButtonText">生成趣味事实</span>
                </button>
                <div id="factOutput" class="mt-8 p-6 bg-gray-800 rounded-xl border border-blue-700 text-slate-300 min-h-[100px] flex items-center justify-center shadow-inner">
                    <p class="text-slate-400 text-center">点击上方按钮获取事实。</p>
                </div>
            </div>
        </section>

        <section id="conclusion" class="pt-16 -mt-16 mb-16">
            <div class="card text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold section-title mb-8">结语：无尽的前沿</h2>
                <p class="text-xl text-slate-300 leading-relaxed max-w-4xl mx-auto">
                    太阳系边际的探索是人类对未知世界永恒好奇心的体现，它不仅拓展了我们对宇宙的认知边界，更提供了理解太阳系形成、演化以及生命起源的关键线索。从柯伊伯带中原始星子的残余，到奥尔特云中彗星的摇篮，再到日球层作为抵御星际宇宙射线的宇宙盾牌，每一次探测都加深了我们对自身在宇宙中位置的理解。这些遥远区域的物质组成和动力学特性，直接反映了早期行星形成过程的细节，而日球层对生命条件的塑造作用，则将地球的宜居性与更广阔的宇宙环境紧密相连。通过研究这些独特的“宇宙实验室”，我们能够推断出适用于其他恒星系统和整个银河系的普遍规律，从而更接近解答“我们在宇宙中是否孤独”这一终极问题。
                </p>
                <p class="text-xl text-slate-300 leading-relaxed max-w-4xl mx-auto mt-6">
                    尽管深空探索面临着严峻的技术挑战，包括超远距离通信的信号衰减和延迟、极端环境下的航天器生存、高精度导航的复杂性以及长寿命能源系统的需求，但人类的智慧和创新精神正不断突破这些极限。旅行者号和新视野号的成功经验，特别是其冗余设计、自主故障保护能力以及任务团队的创造性和适应性，为未来的任务奠定了坚实基础。核电推进、深空光通信、先进材料和仪器小型化等前沿技术的发展，预示着一个更加雄心勃勃的深空探索新纪元。这些努力不仅服务于纯粹的科学发现，也推动了地球上的技术进步，例如GPS技术、太阳能电池板和应急信标等，都源于空间探索的需求。这种持续的探索，激发了全人类对宇宙的共同愿景，并不断拓展着人类文明的边界。
                </p>
                <div class="mt-10 p-8 bg-gray-800 rounded-xl border border-blue-700 shadow-xl text-left">
                    <h3 class="text-3xl font-semibold text-blue-400 mb-6 text-center">核心发现与行动建议</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-2xl font-semibold text-blue-300 mb-4">核心发现：</h4>
                            <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                                <li><strong>日球层作为动态边界：</strong> 其与星际介质的动态相互作用塑造着内部环境，现有探测器未能充分测量关键的等离子体组成（如拾取离子）。</li>
                                <li><strong>柯伊伯带的未解之谜：</strong> 真实天体数量、尘埃生产机制以及离散天体起源仍是悬而未决的问题。</li>
                                <li><strong>奥尔特云的理论性：</strong> 缺乏直接观测数据来验证其形成、演化和确切组成。</li>
                                <li><strong>星际介质的关键影响：</strong> 其组成和特性直接影响日球层的形状、大小和保护能力。</li>
                                <li><strong>技术瓶颈与机遇：</strong> 现有探测器无法满足未来高分辨率、高数据量、长寿命的深空探测需求，但新兴技术提供了突破可能。</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-2xl font-semibold text-blue-300 mb-4">行动建议：</h4>
                            <ul class="list-disc list-inside text-slate-300 space-y-3 pl-4">
                                <li><strong>优先发展先进推进系统：</strong> 投入研发核电推进（NEP）和太阳帆技术，优化引力辅助与有动力近日点机动的混合轨道设计。</li>
                                <li><strong>确保长期电源供应：</strong> 加大对先进斯特林放射性同位素发生器（ASRG）的研发和飞行验证，探索小型裂变电源系统。</li>
                                <li><strong>加速深空光通信技术部署：</strong> 将DSOC作为下一代深空任务的标配，优化激光指向精度、抗干扰能力和地面接收基础设施。</li>
                                <li><strong>推进材料科学与工程创新：</strong> 研发耐极端环境的新型材料，优化热控系统设计。</li>
                                <li><strong>集成小型化、多功能科学载荷：</strong> 开发小型化、低功耗但高灵敏度的科学仪器，实现多学科交叉的科学目标。</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer class="text-center py-10 border-t border-slate-700 bg-gray-900">
        <p class="text-base text-slate-500 mb-2">内容基于“太阳系边际探测：科学前沿与技术挑战”报告生成。</p>
        <p class="text-base text-slate-500">交互式应用由AI构建。仅供演示与学习。 &copy; 2025</p>
    </footer>

    <script>
        // Smooth scrolling for navigation
        var mobileMenuButton = document.getElementById('mobileMenuButton');
        var mobileMenu = document.getElementById('mobileMenu');
        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
        }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                var targetId = this.getAttribute('href');
                var targetElement = document.querySelector(targetId);
                if (targetElement) {
                    var navHeight = document.querySelector('nav').offsetHeight;
                    var elementPosition = targetElement.getBoundingClientRect().top;
                    var offsetPosition = elementPosition + window.pageYOffset - navHeight;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Highlight active navigation link on scroll
        var sections = document.querySelectorAll('section[id]');
        var navLinks = document.querySelectorAll('nav a[href^="#"]');
        
        window.addEventListener('scroll', () => {
            var current = '';
            var navHeight = document.querySelector('nav').offsetHeight;

            sections.forEach(section => {
                var sectionTop = section.offsetTop - navHeight - 50;
                if (pageYOffset >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) {
                    link.classList.add('active');
                }
            });
        });

        // Boundary Details Modal Logic
        var boundaryDetailModal = document.getElementById('boundaryDetailModal');
        var closeModalButton = document.getElementById('closeModalButton');
        var modalTitle = document.getElementById('modalTitle');
        var modalContent = document.getElementById('modalContent');

        var boundaryDetails = {
            kuiper: {
                title: "柯伊伯带 (Kuiper Belt)",
                content: `
                    <p><strong>定义:</strong> 海王星轨道以外的广阔冰冷天体区域，是太阳系早期历史的残余物。</p>
                    <p><strong>距离太阳 (近似):</strong> 30 - 1,000 AU (天文单位)，其“散射盘”甚至可延伸至近1000天文单位。</p>
                    <p><strong>组成/特征:</strong> 主要由冰（水冰、甲烷冰、氨冰）和岩石构成。包含数百万个柯伊伯带天体 (KBOs)，其中包括冥王星、阋神星等矮行星。其形状更像一个厚实的圆盘。天体多样，包括“冷”经典KBOs和“热”经典KBOs，以及被海王星散射到高度椭圆轨道的散射盘天体。</p>
                    <p><strong>探测意义:</strong> 研究柯伊伯带天体有助于理解行星形成过程、太阳系早期物质分布和演化路径，以及彗星的起源。冥王星与海王星的3:2轨道共振使其被归类为冥王星族天体。</p>
                `
            },
            heliopause: {
                title: "日球层顶 (Heliosphere & Heliopause)",
                content: `
                    <p><strong>定义:</strong> 太阳风在星际介质中吹出的巨大“气泡”称为日球层。日球层顶是太阳风压力与星际介质压力相等的边界，标志着太阳影响范围的磁性边界。</p>
                    <p><strong>距离太阳 (近似):</strong> 约 123 - 140 AU。其形状并非完美球形，可能呈泪滴状或更复杂形态。</p>
                    <p><strong>组成/特征:</strong> 包含终端激波（太阳风减速处）和日鞘（终端激波与日球层顶之间的区域）。主要由太阳风等离子体构成，与星际气体、尘埃和宇宙射线相互作用。</p>
                    <p><strong>探测意义:</strong> 理解太阳系如何与星际介质相互作用，研究日球层如何保护内部行星免受有害银河宇宙射线的侵袭，这对于地球生命的宜居性至关重要。旅行者1号和2号是历史上唯一在日球层外运行的航天器。</p>
                `
            },
            hotwall: {
                title: "热墙 (Hot Wall)",
                content: `
                    <p><strong>定义:</strong> 位于日球层顶外侧，由被太阳风弓形激波加热的星际氢原子形成的区域。</p>
                    <p><strong>距离太阳 (近似):</strong> 约 200 AU。</p>
                    <p><strong>组成/特征:</strong> 主要由被加热到约6000开尔文的星际中性氢原子构成。这些原子在进入日球层顶前的弓形激波区域被加热。</p>
                    <p><strong>探测意义:</strong> 探测热墙有助于我们理解太阳系与星际介质的精确相互作用过程，特别是星际氢原子如何穿透日球层并影响其内部环境。它是研究星际介质物理状态的关键区域。</p>
                `
            },
            oort: {
                title: "奥尔特云 (Oort Cloud)",
                content: `
                    <p><strong>定义:</strong> 一个理论上存在的、极其遥远的冰冷天体球状壳层，环绕着太阳系。</p>
                    <p><strong>距离太阳 (近似):</strong> 3,000 - 100,000 AU，甚至可能达到200,000天文单位，延伸至太阳引力影响的遥远边缘，是太阳系的宇宙学边界。</p>
                    <p><strong>组成/特征:</strong> 主要由冰质彗星状天体构成。这些天体被认为是太阳系形成初期在内侧形成后被巨行星引力抛射至外围的，是大多数长周期彗星和哈雷型彗星的来源。</p>
                    <p><strong>探测意义:</strong> 奥尔特云作为太阳系最外层受太阳和银河引力共同影响的区域，代表了太阳系演化与银河系动力学交汇的独特区域。研究它能提供关于太阳系早期物质分布、行星迁移历史以及彗星来源的宝贵线索。凭借目前的成像技术，无法直接观测到奥尔特云。</p>
                `
            },
            ism: {
                title: "局部星际介质 (Local Interstellar Medium)",
                content: `
                    <p><strong>定义:</strong> 存在于星系中恒星系统之间的物质和辐射，主要由氢和氦组成，但也包含尘埃和宇宙射线。它充满着星际空间，并平滑地融入周围的星系际介质。</p>
                    <p><strong>距离太阳 (近似):</strong> 位于日球层之外 (>140 AU)。</p>
                    <p><strong>组成/特征:</strong> 主要由氢、氦、尘埃和宇宙射线构成。它并非一个静态的真空区域，而是一个动态环境，直接影响着日球层，并与太阳风的相互作用形成了日球层的边界。</p>
                    <p><strong>探测意义:</strong> 理解星际介质对于理解太阳系的“空间天气”及其在银河系中的长期演化至关重要。它在天体物理学中扮演着至关重要的角色，因为恒星在其最致密的区域内形成，并通过恒星演化过程得到补充。</p>
                `
            }
        };

        function showBoundaryDetail(boundaryKey) {
            if (boundaryDetails[boundaryKey]) {
                modalTitle.textContent = boundaryDetails[boundaryKey].title;
                modalContent.innerHTML = boundaryDetails[boundaryKey].content;
                boundaryDetailModal.classList.remove('hidden');
            }
        }
        if(closeModalButton) {
            closeModalButton.addEventListener('click', () => {
                boundaryDetailModal.classList.add('hidden');
            });
        }
        if(boundaryDetailModal) {
            boundaryDetailModal.addEventListener('click', (event) => {
                if (event.target === boundaryDetailModal) {
                    boundaryDetailModal.classList.add('hidden');
                }
            });
        }

        // Technology Tabs Logic
        var techTabsContainer = document.getElementById('techTabsContainer');
        var techTabContents = document.querySelectorAll('#techTabContent .tab-content');
        if (techTabsContainer) {
            techTabsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-button')) {
                    var tabName = e.target.dataset.tab;
                    
                    techTabsContainer.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    techTabContents.forEach(content => {
                        if (content.dataset.tabContent === tabName) {
                            content.classList.remove('hidden');
                            content.classList.add('active');
                        } else {
                            content.classList.add('hidden');
                            content.classList.remove('active');
                        }
                    });
                }
            });
        }

        // Chart.js Utilities
        function processChartLabels(labels, maxLength = 16) {
            return labels.map(label => {
                if (typeof label === 'string' && label.length > maxLength) {
                    var words = label.split(' ');
                    var lines = [];
                    var currentLine = '';
                    for (var word of words) {
                        if ((currentLine + word).length > maxLength && currentLine.length > 0) {
                            lines.push(currentLine.trim());
                            currentLine = word + ' ';
                        } else {
                            currentLine += word + ' ';
                        }
                    }
                    lines.push(currentLine.trim());
                    return lines;
                }
                return label;
            });
        }

        var commonChartTooltipOptions = {
            callbacks: {
                title: function(tooltipItems) {
                    var item = tooltipItems[0];
                    if (!item) return '';
                    var label = item.chart.data.labels[item.dataIndex];
                    return Array.isArray(label) ? label.join(' ') : label;
                }
            }
        };
        
        var commonChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: { color: '#94a3b8' } /* Light grey for legend text */
                },
                tooltip: commonChartTooltipOptions
            },
            scales: {
                x: {
                    ticks: { color: '#94a3b8' },
                    grid: { color: 'rgba(71, 85, 105, 0.3)' } /* Darker grid lines */
                },
                y: {
                    ticks: { color: '#94a3b8' },
                    grid: { color: 'rgba(71, 85, 105, 0.3)' },
                    beginAtZero: true
                }
            }
        };

        // Heliosphere Protection Chart
        var heliosphereCtx = document.getElementById('heliosphereProtectionChart');
        if (heliosphereCtx) {
            new Chart(heliosphereCtx, {
                type: 'doughnut',
                data: {
                    labels: processChartLabels(['被偏转/调制的GCRs', '穿透的GCRs (示意)']),
                    datasets: [{
                        label: '日球层对银河宇宙射线(GCRs)的防护作用',
                        data: [85, 15],
                        backgroundColor: ['#60a5fa', '#fcd34d'], /* Blue and Yellow */
                        borderColor: '#1f2937', /* Matches card background */
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { color: '#94a3b8'} },
                        tooltip: commonChartTooltipOptions
                    }
                }
            });
        }

        // Future Probe Capabilities Chart (Radar)
        var futureProbeCtx = document.getElementById('futureProbeCapabilitiesChart');
        if (futureProbeCtx) {
            new Chart(futureProbeCtx, {
                type: 'radar',
                data: {
                    labels: processChartLabels(['最远探测距离', '数据传输速率', '任务设计寿命', '科学仪器功率', '自主运行能力']),
                    datasets: [
                        {
                            label: '旅行者号 (示意)',
                            data: [70, 30, 90, 40, 60],
                            backgroundColor: 'rgba(96, 165, 250, 0.2)', /* Light blue transparent */
                            borderColor: '#60a5fa', /* Light blue */
                            pointBackgroundColor: '#60a5fa'
                        },
                        {
                            label: '星际探测器概念 (示意)',
                            data: [100, 80, 100, 85, 95],
                            backgroundColor: 'rgba(167, 139, 250, 0.2)', /* Purple transparent */
                            borderColor: '#a78bfa', /* Purple */
                            pointBackgroundColor: '#a78bfa'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { color: '#94a3b8'} },
                        tooltip: commonChartTooltipOptions
                    },
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(71, 85, 105, 0.3)' },
                            grid: { color: 'rgba(71, 85, 105, 0.3)' },
                            pointLabels: { color: '#94a3b8', font: {size: 12} },
                            ticks: {
                                backdropColor: 'rgba(0,0,0,0)',
                                color: '#94a3b8',
                                stepSize: 20
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
        }

        // Voyager Lifespan calculation
        var voyagerLifespanElement = document.getElementById('voyagerLifespan');
        if (voyagerLifespanElement) {
            var launchYear = 1977;
            var currentYear = new Date().getFullYear();
            voyagerLifespanElement.textContent = (currentYear - launchYear) + "+";
        }

        // LLM Integration for Q&A, Mission Inspiration, Fact Generator
        var qaInput = document.getElementById('qaInput');
        var askQuestionBtn = document.getElementById('askQuestionBtn');
        var qaSpinner = document.getElementById('qaSpinner');
        var qaButtonText = document.getElementById('qaButtonText');
        var qaOutput = document.getElementById('qaOutput');

        var missionConceptInput = document.getElementById('missionConceptInput');
        var generateMissionConceptBtn = document.getElementById('generateMissionConceptBtn');
        var missionSpinner = document.getElementById('missionSpinner');
        var missionButtonText = document.getElementById('missionButtonText');
        var missionConceptOutput = document.getElementById('missionConceptOutput');

        async function callGeminiApi(prompt, schema = null) {
            var chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            
            var payload = { contents: chatHistory };
            if (schema) {
                payload.generationConfig = {
                    responseMimeType: "application/json",
                    responseSchema: schema
                };
            }

            var apiKey = "";
            var apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                var response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                var result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    if (schema) {
                        var json = result.candidates[0].content.parts[0].text;
                        return JSON.parse(json);
                    } else {
                        return result.candidates[0].content.parts[0].text;
                    }
                } else {
                    console.error("Unexpected API response structure:", result);
                    return "抱歉，无法获取答案。请稍后再试。";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "抱歉，请求失败。请检查网络连接或稍后再试。";
            }
        }

        if (askQuestionBtn) {
            askQuestionBtn.addEventListener('click', async () => {
                var question = qaInput.value.trim();
                if (!question) {
                    qaOutput.innerHTML = '<p class="text-slate-400 text-center">请输入您的问题。</p>';
                    return;
                }

                qaSpinner.classList.remove('hidden');
                qaButtonText.textContent = '思考中...';
                askQuestionBtn.disabled = true;
                qaOutput.innerHTML = '<p class="text-slate-400 text-center">正在生成答案...</p>';

                var prompt = `请简洁地回答以下关于太阳系边际探测的问题："${question}"。请确保答案是中文。`;
                var answer = await callGeminiApi(prompt);

                qaOutput.innerHTML = `<p>${answer}</p>`;
                qaSpinner.classList.add('hidden');
                qaButtonText.textContent = '提问';
                askQuestionBtn.disabled = false;
            });
        }

        if (generateMissionConceptBtn) {
            generateMissionConceptBtn.addEventListener('click', async () => {
                var missionIdea = missionConceptInput.value.trim();
                if (!missionIdea) {
                    missionConceptOutput.innerHTML = '<p class="text-slate-400 text-center">请输入您的任务想法。</p>';
                    return;
                }

                missionSpinner.classList.remove('hidden');
                missionButtonText.textContent = '生成中...';
                generateMissionConceptBtn.disabled = true;
                missionConceptOutput.innerHTML = '<p class="text-slate-400 text-center">正在构想任务...</p>';

                var missionSchema = {
                    type: "OBJECT",
                    properties: {
                        missionName: { type: "STRING" },
                        mainGoal: { type: "STRING" },
                        technicalChallenges: {
                            type: "ARRAY",
                            items: { type: "STRING" }
                        },
                        potentialDiscoveries: {
                            type: "ARRAY",
                            items: { type: "STRING" }
                        }
                    },
                    propertyOrdering: ["missionName", "mainGoal", "technicalChallenges", "potentialDiscoveries"]
                };

                var prompt = `根据这个任务想法："${missionIdea}"，构想一个未来太阳系边际探测任务。请提供任务名称、主要目标、技术挑战和潜在发现，并以中文JSON格式返回。`;
                var concept = await callGeminiApi(prompt, missionSchema);

                if (typeof concept === 'object' && concept !== null && !Array.isArray(concept)) {
                    var outputHtml = `<h4 class="font-semibold text-blue-300 mb-3">${concept.missionName || '未知任务'}</h4>`;
                    outputHtml += `<p class="mb-3"><span class="font-semibold text-blue-400">主要目标：</span> ${concept.mainGoal || '无'}</p>`;
                    
                    if (concept.technicalChallenges && concept.technicalChallenges.length > 0) {
                        outputHtml += `<p class="mb-3"><span class="font-semibold text-blue-400">技术挑战：</span></p><ul class="list-disc list-inside ml-6 space-y-2">`;
                        concept.technicalChallenges.forEach(challenge => {
                            outputHtml += `<li>${challenge}</li>`;
                        });
                        outputHtml += `</ul>`;
                    } else {
                        outputHtml += `<p class="mb-3"><span class="font-semibold text-blue-400">技术挑战：</span> 无</p>`;
                    }

                    if (concept.potentialDiscoveries && concept.potentialDiscoveries.length > 0) {
                        outputHtml += `<p class="mb-3"><span class="font-semibold text-blue-400">潜在发现：</span></p><ul class="list-disc list-inside ml-6 space-y-2">`;
                        concept.potentialDiscoveries.forEach(discovery => {
                            outputHtml += `<li>${discovery}</li>`;
                        });
                        outputHtml += `</ul>`;
                    } else {
                        outputHtml += `<p class="mb-3"><span class="font-semibold text-blue-400">潜在发现：</span> 无</p>`;
                    }
                    missionConceptOutput.innerHTML = outputHtml;
                } else {
                    missionConceptOutput.innerHTML = `<p class="text-red-400">无法生成有效的任务构想。${concept}</p>`;
                }

                missionSpinner.classList.add('hidden');
                missionButtonText.textContent = '生成构想';
                generateMissionConceptBtn.disabled = false;
            });
        }

        // Scaled Map Logic
        var planetsData = [
            { name: "太阳", location: "E1B215教室", distanceAU: 0, color: "#facc15" }, /* Gold */
            { name: "水星", location: "E1B入口", distanceAU: 0.39, color: "#94a3b8" }, /* Slate */
            { name: "金星", location: "恐龙雕像", distanceAU: 0.72, color: "#f97316" }, /* Orange */
            { name: "地球", location: "岭南阁", distanceAU: 1.0, color: "#3b82f6" }, /* Blue */
            { name: "火星", location: "求真广场", distanceAU: 1.52, color: "#ef4444" }, /* Red */
            { name: "木星", location: "珙桐宿舍", distanceAU: 5.2, color: "#fcd34d" }, /* Yellow */
            { name: "土星", location: "行星中心", distanceAU: 9.58, color: "#fbbf24" }, /* Amber */
            { name: "天王星", location: "花园城", distanceAU: 19.2, color: "#22d3ee" }, /* Cyan */
            { name: "海王星", location: "东郊记忆", distanceAU: 30.05, color: "#60a5fa" }, /* Light Blue */
            { name: "冥王星", location: "建设路小吃街", distanceAU: 39.48, color: "#94a3b8" }, /* Slate */
            { name: "柯伊伯带", location: "万象城", distanceAU: 50, color: "#cbd5e1" }, /* Light Slate */
            { name: "奥尔特云", location: "6800公里外", distanceAU: 100000, color: "#e2e8f0" }, /* Even Lighter Slate */
        ];

        var maxAU = 100000;

        var solarSystemProgressBar = document.getElementById('solarSystemProgressBar');
        var planetCardsGrid = document.getElementById('planetCardsGrid');
        var planetDetailModal = document.getElementById('planetDetailModal');
        var closePlanetModalButton = document.getElementById('closePlanetModalButton');
        var planetModalTitle = document.getElementById('planetModalTitle');
        var planetModalContent = document.getElementById('planetModalContent');

        function renderSolarSystemMap() {
            if (!solarSystemProgressBar || !planetCardsGrid) return;

            solarSystemProgressBar.innerHTML = '';
            planetCardsGrid.innerHTML = '';

            planetsData.forEach((planet, index) => {
                var left = `${(planet.distanceAU / maxAU) * 100}%`;
                var indicator = document.createElement('div');
                indicator.className = 'planet-indicator';
                indicator.style.left = left;
                indicator.style.backgroundColor = planet.color;
                indicator.title = `${planet.name} - ${planet.location}`;
                indicator.style.transitionDelay = `${index * 0.05}s`; /* Faster animation */
                
                indicator.addEventListener('click', () => {
                    planetModalTitle.textContent = planet.name;
                    planetModalContent.innerHTML = `
                        <p class="text-lg text-slate-300 mb-3">📍 ${planet.location}</p>
                        <p class="text-lg text-slate-300 mb-3">🌌 距离太阳：${planet.distanceAU} AU</p>
                        <p class="text-lg text-slate-300">📏 约 ${(planet.distanceAU * 149.6).toFixed(2)} 百万公里</p>
                    `;
                    planetDetailModal.classList.remove('hidden');
                });
                solarSystemProgressBar.appendChild(indicator);

                setTimeout(() => {
                    indicator.classList.add('animate-in');
                }, 10);
            });

            planetsData.forEach((planet, index) => {
                var card = document.createElement('div');
                card.className = 'planet-card-item';
                card.innerHTML = `
                    <h2 class="text-2xl" style="color: ${planet.color};">${planet.name}</h2>
                    <p>📍 ${planet.location}</p>
                    <p>☄️ 距离太阳：${planet.distanceAU} AU</p>
                    <p>📏 ≈ ${(planet.distanceAU * 149.6).toFixed(2)} 百万公里</p>
                `;
                planetCardsGrid.appendChild(card);
            });
        }

        if (closePlanetModalButton) {
            closePlanetModalButton.addEventListener('click', () => {
                planetDetailModal.classList.add('hidden');
            });
        }
        if (planetDetailModal) {
            planetDetailModal.addEventListener('click', (event) => {
                if (event.target === planetDetailModal) {
                    planetDetailModal.classList.add('hidden');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', renderSolarSystemMap);

        // Earth Importance Table Logic
        var importanceData = [
            {
                title: "宇宙射线防护",
                summary: "日球层保护地球免受高能宇宙射线侵害。",
                detail: `
                    <p><strong>详细说明:</strong> 太阳风形成的日球层是地球和其他行星的天然屏障，能够偏转和调制来自银河系的高能宇宙射线（GCRs）。这些GCRs对生物体有害，可能导致DNA损伤、癌症风险增加，并对宇航员健康和航天器电子设备构成威胁。通过研究日球层对GCRs的防护机制，我们能更好地理解地球生命的宜居条件，并为未来的载人深空任务开发更有效的辐射防护技术。</p>
                    <p><strong>相关研究:</strong> 旅行者号探测器直接测量了日球层顶内外的宇宙射线强度，证实了日球层的保护作用。</p>
                `
            },
            {
                title: "地球气候与太阳活动",
                summary: "了解太阳活动对地球气候的长期影响。",
                detail: `
                    <p><strong>详细说明:</strong> 太阳活动（如太阳风、太阳耀斑、日冕物质抛射）的变化会影响地球磁场、电离层和大气层。虽然短期影响有限，但长期来看，太阳活动周期可能与地球气候的某些变化模式相关。通过深空探测，我们可以更精确地监测太阳风和星际介质的相互作用，从而提升对太阳活动及其对地球气候影响的预测能力。</p>
                    <p><strong>相关研究:</strong> 对太阳风和星际介质的持续监测有助于建立更精确的太阳-地球关系模型。</p>
                `
            },
            {
                title: "小行星与彗星预警",
                summary: "探测太阳系边缘天体，提前预警潜在撞击威胁。",
                detail: `
                    <p><strong>详细说明:</strong> 柯伊伯带和奥尔特云是大量小行星和彗星的家园。这些天体在引力扰动下可能进入内太阳系，对地球构成潜在的撞击威胁。通过深空探测，我们可以识别和编目这些遥远的天体，评估其轨道和潜在风险，为地球防御系统提供宝贵的预警时间。新视野号对柯伊伯带天体的探测，就是这一努力的一部分。</p>
                    <p><strong>相关研究:</strong> 对柯伊伯带和奥尔特云天体的编目和轨道分析是行星防御的关键。</p>
                `
            },
            {
                title: "资源探索与利用",
                summary: "寻找未来人类深空活动所需的稀有资源。",
                detail: `
                    <p><strong>详细说明:</strong> 太阳系边缘的冰质天体（如柯伊伯带天体和彗星）富含水冰、甲烷、氨等挥发性物质，这些是未来深空任务（如载人火星任务、月球基地建设）所需的燃料、生命支持和建筑材料。对这些天体组成的研究，有助于评估其资源潜力，为未来的人类深空活动提供补给站的可能性。</p>
                    <p><strong>相关研究:</strong> 彗星和小行星的成分分析揭示了其丰富的挥发物资源。</p>
                `
            },
            {
                title: "技术创新与应用",
                summary: "深空探测推动地球科技进步。",
                detail: `
                    <p><strong>详细说明:</strong> 为了克服深空探测的极端挑战（如超远距离通信、能源自给、极端环境生存、自主导航），科学家和工程师被迫开发出许多前沿技术。这些技术最终会反哺地球，例如GPS、太阳能电池板、图像处理技术、医疗设备等，都受益于空间探索的投入。深空探测是国家科技创新和产业升级的重要驱动力。</p>
                    <p><strong>相关研究:</strong> 激光通信、核推进、自主AI等技术在深空探索中得到验证和发展。</p>
                `
            }
        ];

        function renderImportanceTable() {
            var importanceTableBody = document.getElementById('importanceTableBody');
            if (!importanceTableBody) return;

            importanceTableBody.innerHTML = ''; // Clear existing content

            importanceData.forEach((item, index) => {
                var row = document.createElement('tr');
                row.className = `cursor-pointer transition-colors duration-200 ${index % 2 === 0 ? 'bg-gray-800 hover:bg-gray-700' : 'bg-gray-700 hover:bg-gray-600'}`;
                row.innerHTML = `
                    <td class="py-3 px-6 border-b border-slate-700 text-slate-200 font-medium">${item.title}</td>
                    <td class="py-3 px-6 border-b border-slate-700 text-slate-300">${item.summary}</td>
                `;
                row.addEventListener('click', () => showImportanceDetail(item));
                importanceTableBody.appendChild(row);
            });
        }

        var importanceDetailModal = document.getElementById('importanceDetailModal');
        var closeImportanceModalButton = document.getElementById('closeImportanceModalButton');
        var importanceModalTitle = document.getElementById('importanceModalTitle');
        var importanceModalContent = document.getElementById('importanceModalContent');

        function showImportanceDetail(item) {
            if (importanceDetailModal) {
                importanceModalTitle.textContent = item.title;
                importanceModalContent.innerHTML = item.detail;
                importanceDetailModal.classList.remove('hidden');
            }
        }

        if (closeImportanceModalButton) {
            closeImportanceModalButton.addEventListener('click', () => {
                importanceDetailModal.classList.add('hidden');
            });
        }
        if (importanceDetailModal) {
            importanceDetailModal.addEventListener('click', (event) => {
                if (event.target === importanceDetailModal) {
                    importanceDetailModal.classList.add('hidden');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', renderImportanceTable);

        // Fact Generator Logic
        var generateFactBtn = document.getElementById('generateFactBtn');
        var factSpinner = document.getElementById('factSpinner');
        var factButtonText = document.getElementById('factButtonText');
        var factOutput = document.getElementById('factOutput');

        if (generateFactBtn) {
            generateFactBtn.addEventListener('click', async () => {
                factSpinner.classList.remove('hidden');
                factButtonText.textContent = '生成中...';
                generateFactBtn.disabled = true;
                factOutput.innerHTML = '<p class="text-slate-400 text-center">正在获取趣味事实...</p>';

                var prompt = `提供一个关于太阳系边际探测的有趣事实，用中文。例如：“你知道吗，旅行者1号是第一个进入星际空间的人造物体。”`;
                var fact = await callGeminiApi(prompt);

                factOutput.innerHTML = `<p>${fact}</p>`;
                factSpinner.classList.add('hidden');
                factButtonText.textContent = '生成趣味事实';
                generateFactBtn.disabled = false;
            });
        }

        // Voyager Special Topic Section JavaScript
        var voyagerTimelineData = [
            {
                year: "1977年",
                title: "旅行者1号与2号发射",
                description: "两艘探测器相隔16天发射，利用行星引力弹弓效应，开启了对太阳系外围巨行星的宏伟探测之旅。",
                discoveries: [
                    "任务目标：首次详细探测木星、土星、天王星、海王星，并最终飞出太阳系。",
                    "技术突破：利用行星引力辅助技术，大大缩短了飞行时间并节省了燃料。"
                ],
                icon: "🚀"
            },
            {
                year: "1979年",
                title: "旅行者1号飞越木星",
                description: "旅行者1号首次近距离探测木星及其卫星，揭示了木星系统的惊人细节。",
                discoveries: [
                    "发现木卫一（Io）上的活火山，这是人类首次在太阳系其他天体上观测到火山活动。",
                    "发现木星环的复杂结构和细节。",
                    "详细测量了木星的磁场和辐射带。"
                ],
                icon: "🪐"
            },
            {
                year: "1980年",
                title: "旅行者1号飞越土星",
                description: "旅行者1号对土星及其卫星进行了详细观测，特别是土卫六泰坦。",
                discoveries: [
                    "发现土卫六（Titan）拥有浓厚的大气层，主要由氮气和甲烷组成，为未来探测土卫六提供了重要线索。",
                    "详细拍摄了土星环的复杂结构，包括环缝和环的组成。"
                ],
                icon: "🪐"
            },
            {
                year: "1981年",
                title: "旅行者2号飞越土星",
                description: "旅行者2号继续对土星系统进行补充探测，并利用土星引力前往天王星。",
                discoveries: [
                    "进一步确认了土星环的细节和土卫六大气的特性。",
                    "为后续飞越天王星和海王星奠定基础。"
                ],
                icon: "🪐"
            },
            {
                year: "1986年",
                title: "旅行者2号飞越天王星",
                description: "旅行者2号首次近距离探测天王星，揭示了这颗冰巨星的独特之处。",
                discoveries: [
                    "发现天王星的磁场轴线与自转轴线倾斜近60度，且磁场中心偏离行星中心。",
                    "发现10颗新的卫星和两道新的行星环。",
                    "测量了天王星大气层的组成和温度。"
                ],
                icon: "🧊"
            },
            {
                year: "1989年",
                title: "旅行者2号飞越海王星",
                description: "旅行者2号完成了对太阳系四大巨行星的首次探测，带来了海王星的惊人图像和数据。",
                discoveries: [
                    "发现海王星大气层中的“大黑斑”风暴系统，类似于木星的“大红斑”。",
                    "发现海王星拥有多颗新卫星，包括海卫一（Triton）上活跃的冰火山，表明其内部可能存在活动。",
                    "首次确认海王星的行星环是不完整的弧形结构。"
                ],
                icon: "💧"
            },
            {
                year: "2004年",
                title: "旅行者1号穿越终端激波",
                description: "旅行者1号穿越了终端激波，这是太阳风速度从超音速降至亚音速的区域。",
                discoveries: [
                    "首次直接测量到太阳风减速的边界，验证了日球层模型的预测。",
                    "标志着探测器进入了日鞘区域。"
                ],
                icon: "💨"
            },
            {
                year: "2007年",
                title: "旅行者2号穿越终端激波",
                description: "旅行者2号也穿越了终端激波，提供了更多关于太阳风减速区域的数据。",
                discoveries: [
                    "与旅行者1号的数据相互验证，帮助科学家更好地理解终端激波的动态和结构。"
                ],
                icon: "💨"
            },
            {
                year: "2012年",
                title: "旅行者1号进入星际空间",
                description: "旅行者1号穿越日球层顶，正式进入星际介质，成为人类历史上首个进入星际空间的人造物体。",
                discoveries: [
                    "<strong>星际磁场：：</strong> 探测到磁场强度显著增加，且方向与日球层内部磁场不同，证实了进入星际空间。",
                    "<strong>宇宙射线：：：</strong> 银河宇宙射线（GCRs）强度急剧增加，而太阳系内部的太阳宇宙射线则几乎消失。",
                    "<strong>星际等离子体：：：：</strong> 首次直接测量到星际等离子体的密度，发现其比日球层内部稀薄但温度更高。"
                ],
                icon: "🌌"
            },
            {
                year: "2018年",
                title: "旅行者2号进入星际空间",
                description: "旅行者2号也穿越日球层顶，从不同位置和时间点提供了星际空间的数据，验证并补充了旅行者1号的发现。",
                discoveries: [
                    "<strong>星际磁场：：：</strong> 再次确认星际磁场强度和方向的变化，提供了日球层顶形状的新线索。",
                    "<strong>宇宙射线：：：：</strong> 观测到与旅行者1号类似的宇宙射线变化，增强了对日球层防护作用的理解。",
                    "<strong>星际等离子体：：：：：</strong> 进一步测量了星际等离子体的特性，有助于构建更精确的日球层模型。"
                ],
                icon: "🌌"
            },
            {
                year: "2025年至今",
                title: "持续运行与未来挑战",
                description: "旅行者号探测器仍在继续向外飞行，收集星际空间数据，但面临能源耗尽和仪器关闭的挑战。",
                discoveries: [
                    "<strong>能源衰减：：</strong> 放射性同位素热电发生器（RTG）功率持续衰减，部分仪器已被关闭以延长任务寿命。",
                    "<strong>通信挑战：：：</strong> 信号越来越弱，通信窗口越来越短，需要地面深空网络持续升级和优化。",
                    "<strong>科学价值：：：</strong> 即使只剩少量仪器运行，旅行者号仍是人类唯一能直接测量星际空间环境的探测器，其数据对理解星际介质和日球层演化至关重要。"
                ],
                icon: "⏳"
            }
        ];

        var voyagerTimelineDiv = document.getElementById('voyagerTimeline');
        var voyagerDetailArea = document.getElementById('voyagerDetailArea');
        var voyagerDetailTitle = document.getElementById('voyagerDetailTitle');
        var voyagerDetailDescription = document.getElementById('voyagerDetailDescription');
        var voyagerDiscoveriesList = document.getElementById('voyagerDiscoveriesList');

        function renderVoyagerTimeline() {
            if (!voyagerTimelineDiv) return;

            voyagerTimelineDiv.innerHTML = ''; // Clear existing content

            voyagerTimelineData.forEach((event, index) => {
                var timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.innerHTML = `
                    <div class="timeline-icon">${event.icon}</div>
                    <h4 class="font-semibold text-blue-300">${event.year}: ${event.title}</h4>
                    <p class="text-base text-slate-400">${event.description}</p>
                `;
                timelineItem.addEventListener('click', () => showVoyagerDetail(event));
                voyagerTimelineDiv.appendChild(timelineItem);
            });
        }

        function showVoyagerDetail(event) {
            if (!voyagerDetailArea) return;

            voyagerDetailTitle.textContent = event.title;
            voyagerDetailDescription.textContent = event.description;
            voyagerDiscoveriesList.innerHTML = ''; // Clear previous discoveries

            if (event.discoveries && event.discoveries.length > 0) {
                event.discoveries.forEach(discovery => {
                    var listItem = document.createElement('li');
                    listItem.textContent = discovery;
                    voyagerDiscoveriesList.appendChild(listItem);
                });
                voyagerDetailDiscoveries.style.display = 'block'; // Show discoveries section
            } else {
                voyagerDetailDiscoveries.style.display = 'none'; // Hide if no discoveries
            }

            voyagerDetailArea.classList.remove('hidden');
            // Scroll to the detail area for better UX on mobile
            voyagerDetailArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        document.addEventListener('DOMContentLoaded', renderVoyagerTimeline);

        // Probe Design Section JavaScript
        var designComponents = {
            missionGoal: {
                "Kuiper Belt": { score: 10 },
                "Oort Cloud": { score: 30 },
                "Interstellar Space": { score: 20 }
            },
            powerSystem: {
                "RTG": { score: 10 },
                "SRG": { score: 15 },
                "Small Nuclear Reactor": { score: 25 }
            },
            propulsionSystem: {
                "Chemical Propulsion": { score: 5 },
                "Ion Thruster": { score: 15 },
                "Nuclear Thermal Propulsion": { score: 25 }
            },
            communicationSystem: {
                "Radio (DSN)": { score: 10 },
                "Optical Communication": { score: 20 }
            },
            instrument: {
                "Plasma Spectrometer": { score: 5 },
                "Magnetometer": { score: 5 },
                "Dust Analyzer": { score: 7 },
                "Imaging System": { score: 10 }
            }
        };

        var selectedComponents = {
            missionGoal: null,
            powerSystem: null,
            propulsionSystem: null,
            communicationSystem: null,
            instrument: null
        };

        var designOptionsContainers = {
            missionGoal: document.getElementById('missionGoalOptions'),
            powerSystem: document.getElementById('powerSystemOptions'),
            propulsionSystem: document.getElementById('propulsionSystemOptions'),
            communicationSystem: document.getElementById('communicationSystemOptions'),
            instrument: document.getElementById('instrumentOptions')
        };

        var generateProbeDesignBtn = document.getElementById('generateProbeDesignBtn');
        var probeSummaryDiv = document.getElementById('probeSummary');
        var scoreValueSpan = document.getElementById('scoreValue');
        var feedbackContent = document.getElementById('feedbackContent');

        function updateSelectedClass(container, selectedValue) {
            Array.from(container.children).forEach(label => {
                var radio = label.querySelector('input[type="radio"]');
                if (radio && radio.value === selectedValue) {
                    label.classList.add('selected');
                } else {
                    label.classList.remove('selected');
                }
            });
        }

        function handleOptionClick(type, value) {
            selectedComponents[type] = value;
            updateSelectedClass(designOptionsContainers[type], value);
        }

        for (var type in designOptionsContainers) {
            Array.from(designOptionsContainers[type].children).forEach(label => {
                label.addEventListener('click', () => {
                    handleOptionClick(type, label.dataset.value);
                });
            });
        }

        var designedProbeModifiers = null;
        var designedProbeScore = 0;

        if (generateProbeDesignBtn) {
            generateProbeDesignBtn.addEventListener('click', () => {
                var allSelected = Object.values(selectedComponents).every(val => val !== null);
                if (!allSelected) {
                    probeSummaryDiv.classList.remove('hidden');
                    feedbackContent.innerHTML = '<p class="text-red-400">请选择所有组件来完成您的探测器设计！</p>';
                    scoreValueSpan.textContent = 'N/A';
                    startSimulationBtn.disabled = true;
                    return;
                }

                var totalScore = 0;

                for (var type in selectedComponents) {
                    var selectedValue = selectedComponents[type];
                    if (designComponents[type][selectedValue]) {
                        totalScore += designComponents[type][selectedValue].score;
                    }
                }

                var missionGoal = selectedComponents.missionGoal;
                var powerSystem = selectedComponents.powerSystem;
                var propulsionSystem = selectedComponents.propulsionSystem;
                var communicationSystem = selectedComponents.communicationSystem;
                var instrument = selectedComponents.instrument;

                var currentDesignModifiers = {
                    initialPowerBonus: 0,
                    initialHealthBonus: 0,
                    distancePerEventBonus: 0,
                    powerEfficiencyModifier: 1,
                    healthResilienceModifier: 1,
                    dataCollectionModifier: 1,
                    missionScoreMultiplier: 1
                };

                if (powerSystem === "SRG") {
                    currentDesignModifiers.powerEfficiencyModifier -= 0.1;
                } else if (powerSystem === "Small Nuclear Reactor") {
                    currentDesignModifiers.powerEfficiencyModifier -= 0.2;
                    currentDesignModifiers.initialPowerBonus += 15;
                }

                if (propulsionSystem === "Ion Thruster") {
                    currentDesignModifiers.distancePerEventBonus += 5;
                    currentDesignModifiers.powerEfficiencyModifier -= 0.05;
                } else if (propulsionSystem === "Nuclear Thermal Propulsion") {
                    currentDesignModifiers.distancePerEventBonus += 10;
                    currentDesignModifiers.powerEfficiencyModifier -= 0.1;
                }

                if (instrument === "Imaging System") {
                    currentDesignModifiers.dataCollectionModifier += 0.2;
                }
                if (communicationSystem === "Optical Communication") {
                    currentDesignModifiers.dataCollectionModifier += 0.3;
                }

                if (totalScore > 80) {
                    currentDesignModifiers.initialHealthBonus += 10;
                    currentDesignModifiers.healthResilienceModifier -= 0.1;
                    currentDesignModifiers.missionScoreMultiplier += 0.2;
                } else if (totalScore > 60) {
                    currentDesignModifiers.initialHealthBonus += 5;
                    currentDesignModifiers.healthResilienceModifier -= 0.05;
                    currentDesignModifiers.missionScoreMultiplier += 0.1;
                }

                currentDesignModifiers.powerEfficiencyModifier = Math.max(0.5, currentDesignModifiers.powerEfficiencyModifier);
                currentDesignModifiers.healthResilienceModifier = Math.max(0.5, currentDesignModifiers.healthResilienceModifier);
                currentDesignModifiers.dataCollectionModifier = Math.min(2.0, currentDesignModifiers.dataCollectionModifier);
                currentDesignModifiers.missionScoreMultiplier = Math.min(1.5, currentDesignModifiers.missionScoreMultiplier);

                designedProbeModifiers = currentDesignModifiers;
                designedProbeScore = totalScore;

                totalScore = Math.max(0, totalScore);

                document.getElementById('summaryMissionGoal').textContent = missionGoal;
                document.getElementById('summaryPowerSystem').textContent = powerSystem;
                document.getElementById('summaryPropulsionSystem').textContent = propulsionSystem;
                document.getElementById('summaryCommunicationSystem').textContent = communicationSystem;
                document.getElementById('summaryInstrument').textContent = instrument;
                scoreValueSpan.textContent = totalScore;
                probeSummaryDiv.classList.remove('hidden');

                var feedbackMessage = "";
                if (totalScore < 40) {
                    feedbackMessage = "基础设计，可能难以完成深远任务。建议考虑升级动力和推进系统以达到更远的目标。";
                } else if (totalScore >= 40 && totalScore <= 60) {
                    feedbackMessage = "中等设计，适合部分边缘任务，但可能面临通信或能源挑战。进一步优化可以提升任务成功率。";
                } else if (totalScore > 60 && totalScore <= 80) {
                    feedbackMessage = "优秀设计，平衡了能力与可行性，有望取得重要发现！你的探测器具备执行复杂深空任务的潜力。";
                } else {
                    feedbackMessage = "顶尖设计，具备突破性潜力，是未来深空探索的理想选择！这个探测器配置强大，将是星际空间的真正先驱！";
                }
                feedbackContent.innerHTML = `<p>${feedbackMessage}</p>`;

                startSimulationBtn.disabled = false;
                startSimulationBtn.textContent = '开始模拟';
            });
        }

        probeSummaryDiv.classList.add('hidden');

        // Probe Simulation Logic
        var probeState = {
            distance: 100,
            power: 100,
            health: 100,
            dataCollected: 0,
            missionScore: 0
        };

        var simulationEvents = [
            {
                name: "遭遇高能宇宙射线爆发",
                description: "探测器进入一个高能宇宙射线活跃区域。辐射强度远超预期。",
                options: [
                    {
                        text: "启动紧急辐射防护罩 (消耗能量，保护健康)",
                        effects: { baseDistance: 10, basePower: -15, baseHealth: -5, baseData: 0, baseScoreImpact: 5 },
                        outcome: "成功抵御大部分辐射，但能量消耗较大，系统轻微受损。您做出了明智的决策，保护了探测器！"
                    },
                    {
                        text: "加速穿越该区域 (消耗能量，可能受损)",
                        effects: { baseDistance: 20, basePower: -10, baseHealth: -20, baseData: 0, baseScoreImpact: -5 },
                        outcome: "您选择加速穿越，虽然节省了部分能量，但探测器受到了更严重的辐射损伤。这是高风险的决策！"
                    }
                ]
            },
            {
                name: "探测到未知星际尘埃云",
                description: "科学仪器探测到一片前所未见的星际尘埃云。这是研究星际介质组成的好机会。",
                options: [
                    {
                        text: "调整姿态，详细分析尘埃 (消耗能量，获取数据)",
                        effects: { baseDistance: 10, basePower: -20, baseHealth: -2, baseData: 30, baseScoreImpact: 15 },
                        outcome: "成功收集到大量关于星际尘埃的新数据，对星际物质有了更深入的了解。这项科学发现非常有价值！"
                    },
                    {
                        text: "保持航向，规避尘埃云 (节省能量，错过机会)",
                        effects: { baseDistance: 15, basePower: -5, baseHealth: 0, baseData: 5, baseScoreImpact: 0 },
                        outcome: "您选择规避尘埃云，探测器安全通过，但错失了一次重要的科学发现机会。谨慎是好的，但有时也需要冒险！"
                    }
                ]
            },
            {
                name: "能源系统轻微异常",
                description: "主能源系统出现轻微波动，能量输出不稳定。需要立即采取行动。",
                options: [
                    {
                        text: "切换到备用模块并自检 (消耗健康，确保稳定)",
                        effects: { baseDistance: 10, basePower: -10, baseHealth: -5, baseData: 0, baseScoreImpact: 5 },
                        outcome: "异常得到控制，但部分能量损失，并暴露出系统老化问题。您确保了任务的持续性！"
                    },
                    {
                        text: "尝试修复主模块 (高风险，可能恢复能量)",
                        effects: {
                            baseDistance: 5,
                            basePower: () => Math.random() > 0.5 ? 15 : -20,
                            baseHealth: () => Math.random() > 0.5 ? -2 : -15,
                            baseData: 0,
                            baseScoreImpact: () => Math.random() > 0.5 ? 10 : -10
                        },
                        outcome: "您尝试修复主模块。结果：[随机结果]！这是一个大胆的尝试，但风险很高。"
                    }
                ]
            },
            {
                name: "接收到微弱的引力波信号",
                description: "引力波探测器接收到来自遥远宇宙的微弱信号，需要消耗大量能量进行解析。",
                options: [
                    {
                        text: "全力解析信号 (高能量消耗，高数据收益)",
                        effects: { baseDistance: 10, basePower: -30, baseHealth: 0, baseData: 40, baseScoreImpact: 20 },
                        outcome: "成功解析了大部分引力波数据，可能揭示宇宙深处的奥秘！这项发现将极大提升任务得分！"
                    },
                    {
                        text: "记录信号，不立即解析 (低能量消耗，数据收益低)",
                        effects: { baseDistance: 15, basePower: -5, baseHealth: 0, baseData: 10, baseScoreImpact: 5 },
                        outcome: "您选择记录信号，节省了能量，但只获得了初步数据。未来可能需要更多能量进行详细解析。"
                    }
                ]
            },
            {
                name: "穿越稀薄的星际气体区域",
                description: "探测器正在穿越一片极其稀薄的星际气体区域，环境相对平静。",
                options: [
                    {
                        text: "保持稳定航向，持续收集背景数据",
                        effects: { baseDistance: 15, basePower: -3, baseHealth: 0, baseData: 5, baseScoreImpact: 2 },
                        outcome: "顺利通过，并收集到常规环境数据。平稳的航行是任务成功的基石。"
                    },
                    {
                        text: "短暂加速，快速穿越 (消耗额外能量)",
                        effects: { baseDistance: 25, basePower: -8, baseHealth: 0, baseData: 5, baseScoreImpact: 0 },
                        outcome: "您选择短暂加速，更快地穿越了该区域，但消耗了额外能量。时间就是金钱，但能量也是！"
                    }
                ]
            },
            {
                name: "导航系统校准需求",
                description: "长期飞行导致导航系统出现微小偏差，需要进行一次耗时较长的自主校准。",
                options: [
                    {
                        text: "立即执行高精度校准 (消耗能量，确保精度)",
                        effects: { baseDistance: 5, basePower: -12, baseHealth: 0, baseData: 0, baseScoreImpact: 8 },
                        outcome: "校准成功，航向精度恢复，确保了未来探测的准确性。精确是深空任务的生命线。"
                    },
                    {
                        text: "延迟校准，优先节省能量 (可能影响未来航向)",
                        effects: { baseDistance: 15, basePower: -3, baseHealth: 0, baseData: 0, baseScoreImpact: -3 },
                        outcome: "您选择延迟校准，节省了能量，但未来航向可能出现更大偏差。这可能会影响您找到目标的能力。"
                    }
                ]
            },
            {
                name: "遭遇微流星体群",
                description: "探测器意外进入一片密集的微流星体群，面临撞击风险。",
                options: [
                    {
                        text: "启动紧急规避程序并激活防护罩 (消耗能量，减少损伤)",
                        effects: { baseDistance: 5, basePower: -15, baseHealth: -5, baseData: 0, baseScoreImpact: 5 },
                        outcome: "成功规避大部分撞击，探测器表面受到轻微损伤。您的快速反应保护了探测器！"
                    },
                    {
                        text: "依靠自身结构硬抗 (高风险，可能严重受损)",
                        effects: { baseDistance: 10, basePower: -3, baseHealth: -30, baseData: 0, baseScoreImpact: -15 },
                        outcome: "您选择依靠自身结构硬抗。探测器受到了严重损伤，但能量消耗较少。这是一个非常危险的决策！"
                    }
                ]
            },
            {
                name: "发现奇异的冰质天体",
                description: "成像系统捕捉到一个前所未见的奇异冰质天体，其表面结构异常复杂。",
                options: [
                    {
                        text: "调整轨道，进行近距离观测和数据收集 (高能量消耗，高数据收益)",
                        effects: { baseDistance: 5, basePower: -25, baseHealth: 0, baseData: 50, baseScoreImpact: 25 },
                        outcome: "获取了该天体的高分辨率图像和光谱数据，为柯伊伯带/奥尔特云研究提供了新目标。这是一项突破性的发现！"
                    },
                    {
                        text: "远距离扫描，继续前进 (低能量消耗，数据收益低)",
                        effects: { baseDistance: 20, basePower: -5, baseHealth: 0, baseData: 10, baseScoreImpact: 5 },
                        outcome: "您选择远距离扫描，节省了能量，但错失了近距离探测的宝贵机会。科学发现有时需要付出代价。"
                    }
                ]
            }
        ];

        var simDistanceSpan = document.getElementById('simDistance');
        var simPowerSpan = document.getElementById('simPower');
        var simHealthSpan = document.getElementById('simHealth');
        var simDataSpan = document.getElementById('simData');
        var simMissionScoreSpan = document.getElementById('simMissionScore');
        var simulationEventDisplay = document.getElementById('simulationEventDisplay');
        var simEventNameSpan = document.getElementById('simEventName');
        var simEventDescriptionSpan = document.getElementById('simEventDescription');
        var simulationChoicesDiv = document.getElementById('simulationChoices');
        var simulationResultDisplay = document.getElementById('simulationResultDisplay');
        var simResultDetailsSpan = document.getElementById('simResultDetails');
        var simulationEndDisplay = document.getElementById('simulationEndDisplay');
        var startSimulationBtn = document.getElementById('startSimulationBtn');
        var nextEventBtn = document.getElementById('nextEventBtn');
        var resetSimulationBtn = document.getElementById('resetSimulationBtn');
        var simLogContent = document.getElementById('simLogContent');

        function updateSimulationDisplay() {
            simDistanceSpan.textContent = probeState.distance.toFixed(1);
            simPowerSpan.textContent = probeState.power.toFixed(0);
            simHealthSpan.textContent = probeState.health.toFixed(0);
            simDataSpan.textContent = probeState.dataCollected.toFixed(0);
            simMissionScoreSpan.textContent = probeState.missionScore.toFixed(0);
        }

        function addLogEntry(message, type = 'info') {
            var p = document.createElement('p');
            p.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            if (type === 'error') {
                p.classList.add('text-red-600', 'font-semibold');
            } else if (type === 'success') {
                p.classList.add('text-green-600', 'font-semibold');
            } else if (type === 'event') {
                p.classList.add('text-blue-700', 'font-medium');
            }
            simLogContent.prepend(p);
            if (simLogContent.children.length > 20) {
                simLogContent.removeChild(simLogContent.lastChild);
            }
        }

        function resetSimulation() {
            var initialPower = 100 + (designedProbeModifiers?.initialPowerBonus || 0);
            var initialHealth = 100 + (designedProbeModifiers?.initialHealthBonus || 0);

            probeState = {
                distance: 100,
                power: Math.min(115, initialPower),
                health: Math.min(115, initialHealth),
                dataCollected: 0,
                missionScore: 0
            };
            updateSimulationDisplay();
            simLogContent.innerHTML = '<p class="text-slate-400">等待模拟开始...</p>';
            simulationEventDisplay.classList.add('hidden');
            simulationResultDisplay.classList.add('hidden');
            simulationEndDisplay.classList.add('hidden');
            startSimulationBtn.classList.remove('hidden');
            nextEventBtn.classList.add('hidden');
            resetSimulationBtn.classList.add('hidden');
            simulationChoicesDiv.innerHTML = '';
            startSimulationBtn.disabled = !designedProbeModifiers;
            if (!designedProbeModifiers) {
                startSimulationBtn.textContent = '请先设计探测器';
            } else {
                startSimulationBtn.textContent = '开始模拟';
            }
        }

        function checkGameStatus() {
            if (probeState.power <= 0) {
                endSimulation(`能量耗尽！探测器进入休眠状态，任务失败。最终得分：${probeState.missionScore.toFixed(0)}。`, 'game-over');
                return true;
            }
            if (probeState.health <= 0) {
                endSimulation(`探测器严重受损，失去联系！任务失败。最终得分：${probeState.missionScore.toFixed(0)}。`, 'game-over');
                return true;
            }
            if (probeState.distance >= 500 && probeState.missionScore >= 100) {
                endSimulation(`恭喜！您的探测器已成功抵达 ${probeState.distance.toFixed(1)} AU，并收集了 ${probeState.dataCollected.toFixed(0)} 单位的宝贵数据！最终得分：${probeState.missionScore.toFixed(0)}。人类的星际探索又迈进了一步！`, 'win');
                return true;
            } else if (probeState.distance >= 500 && probeState.missionScore < 100) {
                 endSimulation(`探测器已抵达 ${probeState.distance.toFixed(1)} AU，但任务得分不足（${probeState.missionScore.toFixed(0)} 分）。虽然到达了目的地，但科学产出有限，任务未能完全成功。`, 'game-over');
                 return true;
            }
            return false;
        }

        function endSimulation(message, type) {
            simulationEventDisplay.classList.add('hidden');
            simulationResultDisplay.classList.add('hidden');
            simulationEndDisplay.classList.remove('hidden');
            simulationEndDisplay.className = `simulation-game-over ${type === 'win' ? 'simulation-win' : 'simulation-game-over'}`;
            simulationEndDisplay.innerHTML = `<p>${message}</p>`;
            nextEventBtn.classList.add('hidden');
            resetSimulationBtn.classList.remove('hidden');
            addLogEntry(message, type === 'win' ? 'success' : 'error');
        }

        function handleChoice(choice) {
            Array.from(simulationChoicesDiv.children).forEach(button => button.disabled = true);

            var modifiers = designedProbeModifiers || {
                powerEfficiencyModifier: 1,
                healthResilienceModifier: 1,
                dataCollectionModifier: 1,
                missionScoreMultiplier: 1,
                distancePerEventBonus: 0
            };

            var basePowerEffect = typeof choice.effects.basePower === 'function' ? choice.effects.basePower() : (choice.effects.basePower || 0);
            var baseHealthEffect = typeof choice.effects.baseHealth === 'function' ? choice.effects.baseHealth() : (choice.effects.baseHealth || 0);
            var baseScoreImpactEffect = typeof choice.effects.baseScoreImpact === 'function' ? choice.effects.baseScoreImpact() : (choice.effects.baseScoreImpact || 0);

            var actualPowerChange = basePowerEffect * modifiers.powerEfficiencyModifier;
            var actualHealthChange = baseHealthEffect * modifiers.healthResilienceModifier;
            var actualDataChange = (choice.effects.baseData || 0) * modifiers.dataCollectionModifier;
            var actualScoreImpact = baseScoreImpactEffect * modifiers.missionScoreMultiplier;
            var actualDistanceIncrease = (choice.effects.baseDistance || 0) + modifiers.distancePerEventBonus;

            probeState.distance += actualDistanceIncrease;
            probeState.power += actualPowerChange;
            probeState.health += actualHealthChange;
            probeState.dataCollected += actualDataChange;
            probeState.missionScore += actualScoreImpact;

            probeState.power = Math.max(0, Math.min(100, probeState.power));
            probeState.health = Math.max(0, Math.min(100, probeState.health));
            probeState.dataCollected = Math.max(0, probeState.dataCollected);
            probeState.missionScore = Math.max(0, probeState.missionScore);

            simResultDetailsSpan.innerHTML = choice.outcome;
            simulationResultDisplay.classList.remove('hidden');

            updateSimulationDisplay();

            addLogEntry(`您的选择: ${choice.text}`);
            addLogEntry(`结果: ${choice.outcome}`);
            addLogEntry(`状态更新: 距离+${actualDistanceIncrease.toFixed(1)}AU, 能量${actualPowerChange > 0 ? '+' : ''}${actualPowerChange.toFixed(0)}%, 健康${actualHealthChange > 0 ? '+' : ''}${actualHealthChange.toFixed(0)}%, 数据+${actualDataChange.toFixed(0)}单位, 得分${actualScoreImpact > 0 ? '+' : ''}${actualScoreImpact.toFixed(0)}分。`);

            nextEventBtn.classList.remove('hidden');

            checkGameStatus();
        }

        function processNextEvent() {
            if (checkGameStatus()) {
                return;
            }

            simulationResultDisplay.classList.add('hidden');
            simulationChoicesDiv.innerHTML = '';
            nextEventBtn.classList.add('hidden');

            var eventIndex = Math.floor(Math.random() * simulationEvents.length);
            var currentEvent = simulationEvents[eventIndex];

            simEventNameSpan.textContent = currentEvent.name;
            simEventDescriptionSpan.textContent = currentEvent.description;
            simulationEventDisplay.classList.remove('hidden');

            addLogEntry(`事件: ${currentEvent.name}`, 'event');
            addLogEntry(`描述: ${currentEvent.description}`);

            currentEvent.options.forEach((option, index) => {
                var button = document.createElement('button');
                button.className = 'choice-button';
                button.textContent = option.text;
                button.addEventListener('click', () => handleChoice(option));
                simulationChoicesDiv.appendChild(button);
            });
        }

        startSimulationBtn.addEventListener('click', () => {
            if (!designedProbeModifiers) {
                alert("请先在上方设计您的探测器！");
                return;
            }
            startSimulationBtn.classList.add('hidden');
            nextEventBtn.classList.add('hidden');
            resetSimulationBtn.classList.add('hidden');
            simLogContent.innerHTML = '';
            addLogEntry("模拟开始！探测器正向太阳系边缘进发...", 'info');
            updateSimulationDisplay();
            processNextEvent();
        });

        nextEventBtn.addEventListener('click', processNextEvent);
        resetSimulationBtn.addEventListener('click', resetSimulation);

        resetSimulation();

        // Craft Power & Propulsion System Logic (from nuclear_propulsion_principles_v1)
        var systemTabs = document.getElementById('systemTabs');
        var systemContents = document.querySelectorAll('#systemContent .content-box');

        // Store active 3D animations for each system
        var nuclearPowerAnimations = {};

        function showSystemContent(systemName) {
            // Stop animation of the currently active system
            if (activeNuclearSystem.name && nuclearPowerAnimations[activeNuclearSystem.name]) {
                nuclearPowerAnimations[activeNuclearSystem.name].stop();
            }

            systemTabs.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });

            systemContents.forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });

            var activeButton = systemTabs.querySelector(`[data-system="${systemName}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            var activeContent = document.querySelector(`[data-content="${systemName}"]`);
            if (activeContent) {
                activeContent.classList.add('active');
                activeContent.style.display = 'block';

                // Ensure the 3D scene for this system is initialized
                if (!nuclearPowerScenes[systemName]) {
                    initNuclearPower3D(systemName);
                }

                // IMPORTANT: Resize renderer and update camera AFTER the canvas becomes visible
                var canvas = nuclearPowerCanvases[systemName];
                var camera = nuclearPowerCameras[systemName];
                var renderer = nuclearPowerRenderers[systemName];

                if (canvas && camera && renderer) {
                    camera.aspect = canvas.clientWidth / canvas.clientHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                } else {
                    console.warn(`Could not resize renderer for ${systemName}. Canvas, camera, or renderer not found.`);
                }

                // Start 3D animation for the active tab
                if (nuclearPowerAnimations[systemName] && nuclearPowerAnimations[systemName].start) {
                    nuclearPowerAnimations[systemName].start();
                    activeNuclearSystem.name = systemName; // Set the new active system
                }
            }
        }

        systemTabs.addEventListener('click', (e) => {
            if (e.target.classList.contains('tab-button')) {
                var systemName = e.target.dataset.system;
                showSystemContent(systemName);
            }
        });

        // 3D Solar System Model Initialization
        var solarSystemScene, solarSystemCamera, solarSystemRenderer, solarSystemControls, solarSystemAnimationId;
        var solarSystemCanvas = document.getElementById('solarSystem3DCanvas');

        function initSolarSystem3D() {
            if (!solarSystemCanvas) return;

            // Scene
            solarSystemScene = new THREE.Scene();

            // Camera
            solarSystemCamera = new THREE.PerspectiveCamera(75, solarSystemCanvas.clientWidth / solarSystemCanvas.clientHeight, 0.1, 1000);
            solarSystemCamera.position.z = 150; // Adjust camera position for better view

            // Renderer
            solarSystemRenderer = new THREE.WebGLRenderer({ canvas: solarSystemCanvas, antialias: true });
            solarSystemRenderer.setSize(solarSystemCanvas.clientWidth, solarSystemCanvas.clientHeight);
            solarSystemRenderer.setClearColor(0x0a0a0a, 1); // Dark background for space

            // Lights
            var ambientLight = new THREE.AmbientLight(0x404040); // Soft white light
            solarSystemScene.add(ambientLight);

            var sunLight = new THREE.PointLight(0xffffff, 1, 0); // White light, no decay over distance
            sunLight.position.set(0, 0, 0); // Position at the center (Sun's position)
            solarSystemScene.add(sunLight);

            // Sun (bright sphere)
            var sunGeometry = new THREE.SphereGeometry(10, 32, 32);
            var sunMaterial = new THREE.MeshBasicMaterial({ color: 0xfacc15 }); // Gold color
            var sun = new THREE.Mesh(sunGeometry, sunMaterial);
            solarSystemScene.add(sun);

            // Planets (simplified representation)
            var planets = [
                { name: '水星', radius: 2, distance: 20, color: 0x94a3b8, speed: 0.02 },
                { name: '金星', radius: 3, distance: 30, color: 0xf97316, speed: 0.015 },
                { name: '地球', radius: 3.5, distance: 40, color: 0x3b82f6, speed: 0.01 },
                { name: '火星', radius: 2.5, distance: 50, color: 0xef4444, speed: 0.008 },
                { name: '木星', radius: 7, distance: 70, color: 0xfcd34d, speed: 0.005 },
                { name: '土星', radius: 6, distance: 90, color: 0xfbbf24, speed: 0.004 },
                { name: '天王星', radius: 5, distance: 110, color: 0x22d3ee, speed: 0.003 },
                { name: '海王星', radius: 4.5, distance: 130, color: 0x60a5fa, speed: 0.0025 }
            ];

            planets.forEach(p => {
                var geometry = new THREE.SphereGeometry(p.radius, 16, 16);
                var material = new THREE.MeshLambertMaterial({ color: p.color });
                var planetMesh = new THREE.Mesh(geometry, material);
                planetMesh.name = p.name; // Store name for identification
                
                // Position the planet on its orbit
                planetMesh.position.set(p.distance, 0, 0);
                solarSystemScene.add(planetMesh);

                // Create orbit line
                var orbitGeometry = new THREE.BufferGeometry().setFromPoints(
                    new THREE.EllipseCurve(0, 0, p.distance, p.distance, 0, 2 * Math.PI, false, 0).getPoints(100)
                );
                var orbitMaterial = new THREE.LineBasicMaterial({ color: 0x334155 }); // Dark grey for orbits
                var orbit = new THREE.Line(orbitGeometry, orbitMaterial);
                solarSystemScene.add(orbit);

                // Store planet data for animation
                planetMesh.userData.distance = p.distance;
                planetMesh.userData.speed = p.speed;
            });

            // Boundaries (simplified rings/spheres)
            // Kuiper Belt (represented as a ring)
            var kuiperBeltRadius = 150; // Represents ~50 AU scale
            var kuiperBeltTube = 1;
            var kuiperBeltSegments = 64;
            var kuiperBeltGeometry = new THREE.TorusGeometry(kuiperBeltRadius, kuiperBeltTube, 2, kuiperBeltSegments);
            var kuiperBeltMaterial = new THREE.MeshBasicMaterial({ color: 0x0f766e, transparent: true, opacity: 0.1 }); // Teal, semi-transparent
            var kuiperBelt = new THREE.Mesh(kuiperBeltGeometry, kuiperBeltMaterial);
            kuiperBelt.rotation.x = Math.PI / 2; // Rotate to lie flat
            solarSystemScene.add(kuiperBelt);


            // Heliosphere (represented as a sphere)
            var heliosphereRadius = 200; // Represents ~120-140 AU scale
            var heliosphereGeometry = new THREE.SphereGeometry(heliosphereRadius, 32, 32);
            var heliosphereMaterial = new THREE.MeshBasicMaterial({ color: 0x818cf8, transparent: true, opacity: 0.05 }); // Purple-blue, very transparent
            var heliosphere = new THREE.Mesh(heliosphereGeometry, heliosphereMaterial);
            solarSystemScene.add(heliosphere);

            // Oort Cloud (represented as a larger, very transparent sphere)
            var oortCloudRadius = 300; // Represents ~3000 AU scale (visually compressed)
            var oortCloudGeometry = new THREE.SphereGeometry(oortCloudRadius, 32, 32);
            var oortCloudMaterial = new THREE.MeshBasicMaterial({ color: 0x94a3b8, transparent: true, opacity: 0.02 }); // Light grey, extremely transparent
            var oortCloud = new THREE.Mesh(oortCloudGeometry, oortCloudMaterial);
            solarSystemScene.add(oortCloud);


            // OrbitControls
            // Check if THREE.OrbitControls is available before instantiating
            if (typeof THREE.OrbitControls !== 'undefined') {
                solarSystemControls = new THREE.OrbitControls(solarSystemCamera, solarSystemRenderer.domElement);
                solarSystemControls.enableDamping = true; // smooth camera movement
                solarSystemControls.dampingFactor = 0.05;
                solarSystemControls.screenSpacePanning = false;
                solarSystemControls.minDistance = 20;
                solarSystemControls.maxDistance = 500;
                solarSystemControls.maxPolarAngle = Math.PI / 2; // Prevent camera from going below the "ground"
            } else {
                console.error("THREE.OrbitControls is not defined. Skipping solar system 3D controls initialization.");
            }

            // Handle window resize
            window.addEventListener('resize', onSolarSystemResize, false);
            function onSolarSystemResize() {
                if (!solarSystemCanvas) return;
                solarSystemCamera.aspect = solarSystemCanvas.clientWidth / solarSystemCanvas.clientHeight;
                solarSystemCamera.updateProjectionMatrix();
                solarSystemRenderer.setSize(solarSystemCanvas.clientWidth, solarSystemCanvas.clientHeight);
            }

            // Animation loop
            function animateSolarSystem() {
                solarSystemAnimationId = requestAnimationFrame(animateSolarSystem);

                // Rotate planets
                solarSystemScene.children.forEach(object => {
                    if (object.userData.speed) {
                        object.rotation.y += object.userData.speed; // Rotate the planet on its axis
                        // To simulate orbit, we can update position based on angle
                        object.position.x = object.userData.distance * Math.cos(object.rotation.y);
                        object.position.z = object.userData.distance * Math.sin(object.rotation.y);
                    }
                });

                if (solarSystemControls) { // Only update controls if they were successfully initialized
                    solarSystemControls.update(); // only required if controls.enableDamping is set to true
                }
                solarSystemRenderer.render(solarSystemScene, solarSystemCamera);
            }

            animateSolarSystem();
        }

        // Nuclear Power 3D Visualizations
        var nuclearPowerCanvases = {
            RTG: document.getElementById('rtg3DCanvas'),
            SRG: document.getElementById('srg3DCanvas'),
            NTP: document.getElementById('ntp3DCanvas'),
            NEP: document.getElementById('nep3DCanvas')
        };

        var nuclearPowerScenes = {};
        var nuclearPowerCameras = {};
        var nuclearPowerRenderers = {};
        var nuclearPowerControls = {};
        var nuclearPowerAnimations = {};
        var activeNuclearSystem = { name: null }; // Track which system's animation is active

        function initNuclearPower3D(systemName) {
            var canvas = nuclearPowerCanvases[systemName];
            if (!canvas) {
                console.error(`Canvas element for systemName "${systemName}" not found. Cannot initialize 3D scene.`);
                return;
            }

            // Scene
            var scene = new THREE.Scene();
            nuclearPowerScenes[systemName] = scene;
            scene.userData.model = {}; // Initialize model container

            // Camera - Initialize with a default non-zero aspect ratio
            var camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000); // Default aspect 1:1
            camera.position.z = 5;
            nuclearPowerCameras[systemName] = camera;

            // Renderer - Initialize with a default non-zero size
            var renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
            renderer.setSize(1, 1); // Default small size, will be resized when visible
            renderer.setClearColor(0x0a0a0a, 1);
            nuclearPowerRenderers[systemName] = renderer;

            // Lights
            var ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            var directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(0, 1, 1);
            scene.add(directionalLight);

            // Controls
            var controls;
            if (typeof THREE.OrbitControls !== 'undefined') {
                controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.screenSpacePanning = false;
                controls.minDistance = 2;
                controls.maxDistance = 10;
                nuclearPowerControls[systemName] = controls;
            } else {
                console.error("THREE.OrbitControls is not defined. Skipping nuclear power 3D controls initialization.");
            }


            // Specific model for each system
            switch (systemName) {
                case 'RTG':
                    var rtgCasing = new THREE.Mesh(
                        new THREE.BoxGeometry(2, 2, 2),
                        new THREE.MeshLambertMaterial({ color: 0x607d8b }) // Blue-grey
                    );
                    scene.add(rtgCasing);
                    scene.userData.model.casing = rtgCasing;

                    var heatSource = new THREE.Mesh(
                        new THREE.SphereGeometry(0.5, 16, 16),
                        new THREE.MeshBasicMaterial({ color: 0xffa726 }) // Orange-yellow for heat
                    );
                    heatSource.position.y = 0.5;
                    rtgCasing.add(heatSource);
                    scene.userData.model.heatSource = heatSource;

                    var thermoelectricModules = new THREE.Group();
                    for (var i = 0; i < 4; i++) {
                        var module = new THREE.Mesh(
                            new THREE.BoxGeometry(0.2, 1.8, 0.2),
                            new THREE.MeshLambertMaterial({ color: 0x4caf50 }) // Green for thermoelectric
                        );
                        module.position.set(
                            Math.cos(i * Math.PI / 2) * 0.8,
                            0,
                            Math.sin(i * Math.PI / 2) * 0.8
                        );
                        thermoelectricModules.add(module);
                    }
                    rtgCasing.add(thermoelectricModules);

                    nuclearPowerAnimations[systemName] = {
                        start: function() {
                            function animateRTG() {
                                if (nuclearPowerAnimations[systemName].shouldAnimate) {
                                    rtgCasing.rotation.y += 0.005;
                                    heatSource.rotation.x += 0.01;
                                    if (controls) controls.update();
                                    renderer.render(scene, camera);
                                    nuclearPowerAnimations[systemName].animationFrameId = requestAnimationFrame(animateRTG);
                                }
                            }
                            nuclearPowerAnimations[systemName].shouldAnimate = true;
                            animateRTG();
                        },
                        stop: function() {
                            nuclearPowerAnimations[systemName].shouldAnimate = false;
                            if (nuclearPowerAnimations[systemName].animationFrameId) {
                                cancelAnimationFrame(nuclearPowerAnimations[systemName].animationFrameId);
                            }
                        },
                        animationFrameId: null,
                        shouldAnimate: false
                    };
                    break;

                case 'SRG':
                    var srgCasing = new THREE.Mesh(
                        new THREE.CylinderGeometry(1.2, 1.2, 3, 32),
                        new THREE.MeshLambertMaterial({ color: 0x546e7a }) // Darker grey
                    );
                    scene.add(srgCasing);
                    scene.userData.model.casing = srgCasing;

                    var heatExchanger = new THREE.Mesh(
                        new THREE.SphereGeometry(0.6, 16, 16),
                        new THREE.MeshBasicMaterial({ color: 0xff7043 }) // Red-orange for heat
                    );
                    heatExchanger.position.y = 1.2;
                    srgCasing.add(heatExchanger);
                    scene.userData.model.heatExchanger = heatExchanger;

                    var piston = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.3, 0.3, 0.5, 16),
                        new THREE.MeshLambertMaterial({ color: 0x9e9e9e }) // Grey
                    );
                    piston.position.y = -0.5;
                    srgCasing.add(piston);
                    scene.userData.model.piston = piston;

                    var generator = new THREE.Mesh(
                        new THREE.BoxGeometry(0.8, 0.5, 0.8),
                        new THREE.MeshLambertMaterial({ color: 0x42a5f5 }) // Blue for generator
                    );
                    generator.position.y = -1.2;
                    srgCasing.add(generator);
                    scene.userData.model.generator = generator;

                    nuclearPowerAnimations[systemName] = {
                        start: function() {
                            var pistonDirection = 1;
                            function animateSRG() {
                                if (nuclearPowerAnimations[systemName].shouldAnimate) {
                                    srgCasing.rotation.y += 0.005;
                                    heatExchanger.rotation.x += 0.01;

                                    piston.position.y += pistonDirection * 0.02;
                                    if (piston.position.y > 0.5 || piston.position.y < -0.5) {
                                        pistonDirection *= -1;
                                    }

                                    if (controls) controls.update();
                                    renderer.render(scene, camera);
                                    nuclearPowerAnimations[systemName].animationFrameId = requestAnimationFrame(animateSRG);
                                }
                            }
                            nuclearPowerAnimations[systemName].shouldAnimate = true;
                            animateSRG();
                        },
                        stop: function() {
                            nuclearPowerAnimations[systemName].shouldAnimate = false;
                            if (nuclearPowerAnimations[systemName].animationFrameId) {
                                cancelAnimationFrame(nuclearPowerAnimations[systemName].animationFrameId);
                            }
                        },
                        animationFrameId: null,
                        shouldAnimate: false
                    };
                    break;

                case 'NTP':
                    var reactorCore = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.8, 0.8, 1.5, 32),
                        new THREE.MeshLambertMaterial({ color: 0x8bc34a }) // Light green for reactor
                    );
                    scene.add(reactorCore);
                    scene.userData.model.reactorCore = reactorCore;

                    var nozzle = new THREE.Mesh(
                        new THREE.ConeGeometry(1, 1.5, 32),
                        new THREE.MeshLambertMaterial({ color: 0x757575 }) // Grey for nozzle
                    );
                    nozzle.position.y = -1.5;
                    reactorCore.add(nozzle);
                    scene.userData.model.nozzle = nozzle;

                    var exhaustParticles = new THREE.Group();
                    scene.userData.model.exhaustParticles = exhaustParticles;
                    scene.add(exhaustParticles);

                    nuclearPowerAnimations[systemName] = {
                        start: function() {
                            function animateNTP() {
                                if (nuclearPowerAnimations[systemName].shouldAnimate) {
                                    reactorCore.rotation.y += 0.005;
                                    // Animate exhaust particles
                                    if (Math.random() < 0.2) { // Emit new particles
                                        var particle = new THREE.Mesh(
                                            new THREE.SphereGeometry(0.05, 8, 8),
                                            new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 1 })
                                        );
                                        particle.position.set(
                                            (Math.random() - 0.5) * 0.5,
                                            nozzle.position.y - 0.5,
                                            (Math.random() - 0.5) * 0.5
                                        );
                                        particle.userData.velocity = new THREE.Vector3(
                                            (Math.random() - 0.5) * 0.01,
                                            -0.1 - Math.random() * 0.05,
                                            (Math.random() - 0.5) * 0.01
                                        );
                                        exhaustParticles.add(particle);
                                    }

                                    exhaustParticles.children.forEach(p => {
                                        p.position.add(p.userData.velocity);
                                        p.material.opacity -= 0.02;
                                    });
                                    exhaustParticles.children = exhaustParticles.children.filter(p => p.material.opacity > 0);

                                    if (controls) controls.update();
                                    renderer.render(scene, camera);
                                    nuclearPowerAnimations[systemName].animationFrameId = requestAnimationFrame(animateNTP);
                                }
                            }
                            nuclearPowerAnimations[systemName].shouldAnimate = true;
                            animateNTP();
                        },
                        stop: function() {
                            nuclearPowerAnimations[systemName].shouldAnimate = false;
                            if (nuclearPowerAnimations[systemName].animationFrameId) {
                                cancelAnimationFrame(nuclearPowerAnimations[systemName].animationFrameId);
                            }
                            // Clear particles when stopping
                            if (scene.userData.model.exhaustParticles) {
                                scene.userData.model.exhaustParticles.children.forEach(child => child.geometry.dispose());
                                scene.userData.model.exhaustParticles.children = [];
                            }
                        },
                        animationFrameId: null,
                        shouldAnimate: false
                    };
                    break;

                case 'NEP':
                    var reactorUnit = new THREE.Mesh(
                        new THREE.BoxGeometry(1.5, 1.5, 1.5),
                        new THREE.MeshLambertMaterial({ color: 0x795548 }) // Brownish for reactor unit
                    );
                    scene.add(reactorUnit);
                    scene.userData.model.reactorUnit = reactorUnit;

                    var thrusterBody = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.6, 0.8, 1.0, 32),
                        new THREE.MeshLambertMaterial({ color: 0x424242 }) // Dark grey
                    );
                    thrusterBody.position.x = 1.5;
                    reactorUnit.add(thrusterBody);
                    scene.userData.model.thrusterBody = thrusterBody;

                    var ionBeam = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.1, 0.01, 2, 8),
                        new THREE.MeshBasicMaterial({ color: 0x03a9f4, transparent: true, opacity: 0.8 }) // Light blue for ion beam
                    );
                    ionBeam.position.set(1.5, 0, -1.5);
                    ionBeam.rotation.x = Math.PI / 2;
                    thrusterBody.add(ionBeam);
                    scene.userData.model.ionBeam = ionBeam;

                    nuclearPowerAnimations[systemName] = {
                        start: function() {
                            function animateNEP() {
                                if (nuclearPowerAnimations[systemName].shouldAnimate) {
                                    reactorUnit.rotation.y += 0.005;
                                    ionBeam.scale.y = 0.5 + Math.sin(Date.now() * 0.005) * 0.2; // Pulsating beam
                                    ionBeam.material.opacity = 0.6 + Math.sin(Date.now() * 0.005) * 0.2;

                                    if (controls) controls.update();
                                    renderer.render(scene, camera);
                                    nuclearPowerAnimations[systemName].animationFrameId = requestAnimationFrame(animateNEP);
                                }
                            }
                            nuclearPowerAnimations[systemName].shouldAnimate = true;
                            animateNEP();
                        },
                        stop: function() {
                            nuclearPowerAnimations[systemName].shouldAnimate = false;
                            if (nuclearPowerAnimations[systemName].animationFrameId) {
                                cancelAnimationFrame(nuclearPowerAnimations[systemName].animationFrameId);
                            }
                        },
                        animationFrameId: null,
                        shouldAnimate: false
                    };
                    break;
            }

            // Initial resize and render
            onNuclearPowerResize(systemName);
            renderer.render(scene, camera);
        }

        // Handle window resize for nuclear power canvases
        window.addEventListener('resize', () => {
            for (var systemName in nuclearPowerCanvases) {
                if (nuclearPowerCanvases.hasOwnProperty(systemName)) {
                    onNuclearPowerResize(systemName);
                }
            }
        }, false);

        function onNuclearPowerResize(systemName) {
            var canvas = nuclearPowerCanvases[systemName];
            var camera = nuclearPowerCameras[systemName];
            var renderer = nuclearPowerRenderers[systemName];

            if (canvas && camera && renderer) {
                var parent = canvas.parentElement;
                if (parent) {
                    var width = parent.clientWidth;
                    var height = canvas.clientHeight; // Keep height fixed as per CSS

                    if (width > 0 && height > 0) {
                        camera.aspect = width / height;
                        camera.updateProjectionMatrix();
                        renderer.setSize(width, height);
                    } else {
                        console.warn(`Canvas for ${systemName} has zero dimensions. Skipping resize.`);
                    }
                }
            }
        }

        // Initialize 3D scenes on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            initSolarSystem3D();
            // Initialize the first tab's 3D scene and start its animation
            showSystemContent('RTG');
        });
    </script>
</body>
</html>
