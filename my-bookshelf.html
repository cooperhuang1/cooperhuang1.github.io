<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的书架 - 增强功能版</title>
    <!--
        引入 Tailwind CSS CDN：
        这是一个CSS框架，帮助你快速构建响应式和美观的界面。
        我们用它来快速布局和样式化页面。
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!--
        引入 Font Awesome 图标库：
        提供各种图标，用于导航栏、社交链接等。
    -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!--
        引入 Three.js 库：
        用于在背景中创建动态的3D粒子效果。
    -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        /*
            -------------------------------------------------------------------
            自定义 CSS 样式部分：
            这里定义了一些额外的CSS规则，用于实现更精细的控制、动画和3D效果，
            这些是纯粹的CSS，与Tailwind CSS配合使用。
            -------------------------------------------------------------------
        */

        /* 全局字体设置 */
        body {
            font-family: 'Inter', sans-serif; /* 设置页面默认字体 */
            background-color: #f0f2f5; /* 默认背景色 */
            scroll-behavior: smooth; /* 平滑滚动 */
            overflow-x: hidden; /* 防止水平滚动条 */
        }

        /* 英雄背景区域 (主视觉区域) */
        .hero-background {
            height: 300px; /* 调整高度以适应二级页面 */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* Three.js Canvas 样式 */
        #threejs-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        /* 毛玻璃效果样式 */
        .glass-morphism {
            backdrop-filter: blur(10px) saturate(180%);
            -webkit-backdrop-filter: blur(10px) saturate(180%);
            background-color: rgba(255, 255, 255, 0.75);
            border-radius: 12px;
            border: 1px solid rgba(209, 213, 219, 0.3);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* 导航栏滚动时的样式变化 */
        .navbar-scrolled {
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* 按钮悬停效果 */
        .btn-primary {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        /*
            -------------------------------------------------------------------
            书籍3D效果相关样式：
            这是实现“拿出打开”3D动画的核心CSS。
            -------------------------------------------------------------------
        */
        /* 定义CSS变量，方便统一管理书本尺寸 */
        :root {
            --book-actual-width: 200px;    /* 书本封面实际宽度 */
            --book-actual-height: 280px;   /* 书本实际高度 */
            --book-thickness: 20px;        /* 书本厚度 (书脊宽度) */
            --book-spacing-x: 1rem;        /* 书本之间的水平间距 */
            --book-spacing-y: 1rem;        /* 书架层之间的垂直间距 */
        }

        .book-shelf-item {
            /* 每个书本容器，代表3D空间中的整本书 */
            perspective: 1000px; /* 定义3D透视效果的深度 */
            cursor: pointer; /* 鼠标悬停时显示手型光标 */
            position: relative;
            height: var(--book-actual-height);
            /* 初始宽度为书本的厚度，因为我们只显示书脊 */
            width: var(--book-thickness); /* 初始宽度设置为书脊厚度 */
            margin: var(--book-spacing-y) var(--book-spacing-x); /* 垂直和水平间距 */
            transform-style: preserve-3d; /* 关键：使子元素在3D空间中定位 */
            /* 初始状态：书本侧着放，书脊朝前，稍微倾斜 */
            /* rotateY(-80deg) 使书本侧向显示，rotateX(5deg) 模拟书架的轻微倾斜 */
            transform: rotateX(5deg) rotateY(-80deg) translateY(var(--wave-translate-y, 0px)); /* 增加波浪动画的 translateY */
            /* 调整过渡时间，使波浪动画更丝滑，点击动画也更迅速 */
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            opacity: var(--wave-opacity, 1); /* 增加波浪动画的 opacity */
            z-index: 20; /* 确保书本在书架之上 */
            /* 调整 transform-origin 以便旋转时围绕书脊进行 */
            transform-origin: left center;
        }

        .book-container { /* 新增容器，用于包裹书本主体和封面，实现整体3D变换 */
            width: var(--book-actual-width);
            height: var(--book-actual-height);
            position: absolute;
            top: 0;
            left: 0;
            transform-style: preserve-3d;
            /* 初始状态：将整个书本向右移动，使其书脊与 book-shelf-item 的左边缘对齐 */
            /* 这里需要将书本整体向右移动，使其书脊位于 book-shelf-item 的左边缘 */
            transform: translateX(calc(var(--book-thickness) / 2));
        }

        .book-body { /* 书本主体：包含书脊、封底和书页，这个部分是相对固定的 */
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            /* 初始无额外变换，其内部元素会根据自身变换定位 */
        }

        /* 书本的各个面基础样式 */
        .book-face {
            position: absolute;
            width: 100%; /* 继承父容器 book-container 或 book-body 的宽度 */
            height: 100%;
            backface-visibility: hidden; /* 隐藏背面，防止翻转时内容倒置 */
            background-size: cover;
            background-position: center;
            border-radius: 8px; /* 圆角 */
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* 封面 */
        .front-cover {
            background-image: url('https://placehold.co/200x280/87CEEB/ffffff?text=Book+Cover'); /* 默认封面图 */
            /* 封面位于书本厚度的一半位置，使其在3D空间中正确显示 */
            transform: translateZ(calc(var(--book-thickness) / 2));
            transition: transform 1s ease-in-out; /* 封面翻开动画过渡 */
            transform-origin: left center; /* 封面翻开的旋转中心点为左侧中心 (书脊) */
        }

        /* 封底 */
        .back-cover {
            background-image: url('https://placehold.co/200x280/A9A9A9/ffffff?text=Back+Cover'); /* 默认封底图 */
            /* 封底翻转180度，并位于书本厚度的一半位置 */
            transform: rotateY(180deg) translateZ(calc(var(--book-thickness) / 2));
        }

        /* 书脊 (书本的左侧) */
        .book-spine {
            position: absolute;
            width: var(--book-thickness); /* 书脊的实际厚度 */
            height: 100%;
            background-color: #ccc; /* 书脊颜色 */
            /* 旋转Y轴-90度使其成为侧面，并移动到书本的左边缘 */
            transform: rotateY(-90deg) translateZ(calc(var(--book-thickness) / 2));
            box-shadow: -2px 0 5px rgba(0,0,0,0.1);
            border-radius: 8px 0 0 8px; /* 左侧圆角 */
            display: flex; /* 启用flexbox使书脊上的文本居中 */
            align-items: center; /* 垂直居中 */
            justify-content: center; /* 水平居中 */
            font-size: 0.8rem;
            color: #333;
            writing-mode: vertical-lr; /* 垂直书写模式 (从左到右，从上到下) */
            text-orientation: mixed; /* 混合方向，字符方向保持不变 */
            padding: 5px 0;
            text-align: center;
            white-space: nowrap; /* 防止文本换行 */
            overflow: hidden; /* 隐藏超出书脊的文本 */
            text-overflow: ellipsis; /* 超出部分显示省略号 */
        }

        /* 书本的右侧 (与书脊相对的另一侧) */
        .book-right-side {
            position: absolute;
            width: var(--book-thickness); /* 右侧的实际厚度 */
            height: 100%;
            background-color: #ccc; /* 右侧颜色 */
            /* 旋转Y轴90度使其成为侧面，并移动到书本的右边缘 */
            transform: rotateY(90deg) translateZ(calc(var(--book-thickness) / 2));
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            border-radius: 0 8px 8px 0; /* 右侧圆角 */
            left: calc(100% - var(--book-thickness)); /* 定位到书本的右边缘 */
        }

        /* 书页部分 */
        .book-pages {
            position: absolute;
            width: calc(var(--book-actual-width) - var(--book-thickness) * 2); /* 页面宽度 (排除书脊和右侧厚度) */
            height: calc(var(--book-actual-height) - 16px); /* 页面高度 */
            background-color: #f8f8f8; /* 页面颜色 */
            top: 8px; /* 页面顶部内缩 */
            left: var(--book-thickness); /* 页面从书脊右侧开始 */
            transform: translateZ(calc(var(--book-thickness) / 2 + 1px)); /* 稍微在封面和封底前面 */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
            border-radius: 0 4px 4px 0; /* 右侧圆角 */
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #666;
            text-align: center;
        }

        /* `.is-pulled-out` 类：当书本被点击“拿出”时的状态 */
        .book-shelf-item.is-pulled-out {
            /* 移出书架，并旋转Y轴使其正面朝向用户，同时取消X轴倾斜 */
            /* 关键：将 `rotateY(-80deg)` 变为 `rotateY(0deg)` */
            transform: translateX(0px) translateY(-50px) rotateX(0deg) rotateY(0deg) rotateZ(0deg);
            transform-origin: center center; /* 拿出后旋转中心点回到中心 */
            opacity: 1 !important; /* 确保拿出时完全不透明 */
        }

        /* `.is-open` 类：当书本封面被点击“翻开”时的状态 */
        /* 这个类现在应用于 `front-cover` 元素 */
        .front-cover.is-open {
            /* 修复：调整旋转角度，使其向右前方翻开，更像真实书籍 */
            /* 负值表示逆时针旋转，正值表示顺时针旋转。
               rotateY(-160deg) 意味着封面会向左侧或向后翻转。
               rotateY(160deg) 意味着封面会向右侧翻转，露出内页。
               translateZ 保持其在书本厚度上的位置。
            */
            transform: rotateY(160deg) translateZ(calc(var(--book-thickness) / 2));
        }


        /*
            模态框（弹出窗口）样式：
            用于显示书籍的详细内容和操作按钮。
        */
        .modal-overlay {
            display: none; /* 默认隐藏 */
            position: fixed; /* 固定定位，覆盖整个视口 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* 半透明黑色背景 */
            z-index: 100; /* 确保在最上层 */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 90%;
            overflow-y: auto; /* 内容过多时可滚动 */
            position: relative;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            transform: scale(0.8); /* 初始缩小 */
            opacity: 0; /* 初始透明 */
            transition: transform 0.3s ease-out, opacity 0.3s ease-out; /* 动画过渡 */
        }

        .modal-overlay.show .modal-content {
            transform: scale(1); /* 显示时放大 */
            opacity: 1; /* 显示时完全不透明 */
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.2s;
        }
        .modal-close:hover {
            color: #333;
        }

        /* 暗黑模式下的模态框 */
        .dark .modal-content {
            background-color: #1f2937; /* gray-800 */
            color: #d1d5db; /* gray-300 */
        }
        .dark .modal-close {
            color: #d1d5db;
        }
        .dark .modal-close:hover {
            color: #ffffff;
        }

        /* 书架视觉效果 */
        .bookshelf-row {
            background-color: #a0522d; /* 棕色木头颜色 */
            height: 20px; /* 书架板厚度 */
            width: 100%;
            max-width: 1000px; /* 限制书架宽度 */
            border-radius: 5px;
            margin-top: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1; /* 确保书架在书本后面 */
        }
        .bookshelf-row::before,
        .bookshelf-row::after {
            content: '';
            position: absolute;
            height: 100%;
            width: 10px; /* 侧边支撑 */
            background-color: #8B4513; /* 深棕色 */
            top: 0;
            border-radius: 3px;
        }
        .bookshelf-row::before {
            left: -10px;
        }
        .bookshelf-row::after {
            right: -10px;
        }

        /* 书籍显示区域：用于控制每行书籍的布局和数量 */
        .bookshelf-books-display {
            display: flex;
            flex-wrap: wrap; /* 允许书籍换行 */
            justify-content: center; /* 水平居中书籍 */
            align-items: flex-end; /* 将书籍底部对齐到书架底部 */
            width: 100%;
            max-width: 1000px; /* 限制书籍显示区域的最大宽度，间接控制每行书籍数量 */
            margin: -1rem auto 0 auto; /* 调整负边距，使书籍底部“坐”在书架板上 */
            padding: 0 20px; /* 左右内边距 */
            position: relative;
            z-index: 10;
            min-height: var(--book-actual-height); /* 确保行有足够高度容纳书籍 */
        }

        /* 背景模糊效果 */
        .main-blurred {
            filter: blur(5px); /* 应用5px的高斯模糊 */
            transition: filter 0.3s ease-out; /* 平滑过渡效果 */
        }

        /* 搜索框样式 */
        .search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
            gap: 0.5rem;
        }
        .search-input {
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            width: 100%;
            max-width: 400px;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .search-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        .search-button, .clear-button {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .search-button {
            background-color: #3b82f6;
            color: white;
            border: none;
        }
        .search-button:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
        }
        .clear-button {
            background-color: #ef4444;
            color: white;
            border: none;
        }
        .clear-button:hover {
            background-color: #dc2626;
            transform: translateY(-1px);
        }

        /* 暗黑模式下的搜索框 */
        .dark .search-input {
            background-color: #374151;
            border-color: #4b5563;
            color: #d1d5db;
        }
        .dark .search-input:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.3);
        }

        /* 鼠标悬停提示框样式 */
        .book-tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            white-space: normal; /* 允许文本换行 */
            max-width: 250px; /* 限制提示框宽度 */
            pointer-events: none; /* 确保鼠标事件穿透到下面的书本 */
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            z-index: 50; /* 确保在书本和书架之上 */
            transform: translate(-50%, -110%); /* 向上居中定位 */
            left: 50%;
            top: 0;
            text-align: left;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .book-tooltip.show {
            opacity: 1;
        }
        .book-tooltip h4 {
            font-weight: bold;
            margin-bottom: 0.25rem;
            font-size: 1rem;
        }
        .book-tooltip p {
            font-size: 0.85rem;
            line-height: 1.3;
        }

        /* 左侧信息面板样式 */
        .book-info-panel {
            position: fixed;
            top: 0;
            left: -100%; /* 初始状态隐藏在左侧 */
            width: 350px; /* 面板宽度 */
            max-width: 90%; /* 响应式调整 */
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.2);
            z-index: 90; /* 在主内容之上，在模态框之下 */
            transition: left 0.4s ease-out;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto; /* 内容过多时可滚动 */
            border-right: 1px solid rgba(209, 213, 219, 0.3);
        }
        .book-info-panel.show {
            left: 0; /* 显示时滑入 */
        }
        .book-info-panel .close-panel-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.8rem;
            cursor: pointer;
            color: #666;
            transition: color 0.2s;
        }
        .book-info-panel .close-panel-btn:hover {
            color: #333;
        }
        .book-info-panel .book-cover-display {
            width: 180px;
            height: 252px; /* 保持封面比例 */
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-bottom: 1.5rem;
            flex-shrink: 0; /* 防止封面缩小 */
        }
        .book-info-panel h3 {
            font-size: 1.75rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        .book-info-panel p {
            text-align: center;
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        .book-info-panel .panel-buttons {
            display: flex;
            gap: 1rem;
            margin-top: auto; /* 推到底部 */
        }

        /* 暗黑模式下的左侧信息面板 */
        .dark .book-info-panel {
            background-color: rgba(31, 41, 55, 0.95); /* gray-800 */
            color: #d1d5db; /* gray-300 */
            border-color: rgba(75, 85, 99, 0.3);
        }
        .dark .book-info-panel .close-panel-btn {
            color: #d1d5db;
        }
        .dark .book-info-panel .close-panel-btn:hover {
            color: #ffffff;
        }

        /* 媒体查询：小屏幕适配 */
        @media (max-width: 768px) {
            .book-info-panel {
                width: 100%; /* 小屏幕下全宽 */
                padding: 1.5rem;
            }
            .book-info-panel .book-cover-display {
                width: 150px;
                height: 210px;
            }
            .book-info-panel h3 {
                font-size: 1.5rem;
            }
            .book-info-panel p {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body class="text-gray-800 dark:bg-gray-900 dark:text-gray-200">

    <!--
        -------------------------------------------------------------------
        顶部导航栏 (Navbar) 部分：
        与主页保持一致，提供统一的导航体验。
        -------------------------------------------------------------------
    -->
    <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg shadow-sm transition-all duration-300 ease-in-out">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-blue-600 dark:text-blue-400">我的主页</a>
            
            <div class="hidden md:flex space-x-6">
                <div class="relative dropdown">
                    <a href="#" class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400 cursor-pointer">
                        标签 <i class="fas fa-chevron-down text-xs ml-1"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="frontend-development.html" class="dropdown-item">前端开发</a>
                        <a href="backend-technology.html" class="dropdown-item">后端技术</a>
                        <a href="personal-essays.html" class="dropdown-item">个人随笔</a>
                        <a href="study-notes.html" class="dropdown-item">学习笔记</a>
                        <a href="my-bookshelf.html" class="dropdown-item">我的书架</a>
                    </div>
                </div>
                <a href="#" class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400">分类</a>
                <a href="#" class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400">页面</a>
            </div>

            <div class="flex items-center space-x-4">
                <button class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400">
                    <i class="fas fa-search"></i>
                </button>
                <button class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400">
                    <i class="fas fa-user"></i>
                </button>
                <button id="theme-toggle" class="text-gray-700 hover:text-blue-600 transition duration-300 dark:text-gray-300 dark:hover:text-blue-400">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!--
        -------------------------------------------------------------------
        主视觉区域 (Hero Section)：
        用于展示页面标题和Three.js背景。
        -------------------------------------------------------------------
    -->
    <header class="hero-background relative">
        <canvas id="threejs-background"></canvas>
        <div class="absolute inset-0 bg-black opacity-30 z-10"></div>
        <div class="relative z-20 text-center text-white p-6 rounded-lg glass-morphism">
            <h1 class="text-5xl font-extrabold mb-2">我的书架</h1>
            <p class="text-xl max-w-2xl mx-auto">探索我的知识宝库</p>
        </div>
    </header>

    <!--
        -------------------------------------------------------------------
        书架内容区域 (Main Content Section)：
        展示书籍列表，每本书都可点击并触发3D打开效果。
        -------------------------------------------------------------------
    -->
    <main id="main-content" class="container mx-auto px-4 py-12 relative z-20">
        <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-8 text-center">前端开发书籍</h2>
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="搜索书名、作者或简介..." class="search-input">
            <button id="searchButton" class="search-button">
                <i class="fas fa-search"></i> 搜索
            </button>
            <button id="clearSearchButton" class="clear-button">
                <i class="fas fa-times"></i> 清除
            </button>
        </div>

        <div class="flex flex-col items-center">
            <div class="bookshelf-row"></div>
            <div id="bookshelf-container-1" class="bookshelf-books-display">
                <!--
                    书本示例 1：
                    复制此 `book-shelf-item` 块以添加更多书籍。
                    请替换 `data-title`, `data-author`, `data-page-url`, `data-summary`, `data-cover-url` 和 `data-spine-text`。
                    `data-page-url` 是点击“进入详情页”后跳转到的三级标签页的URL (可以是HTML或PDF)。
                    `data-summary` 是在模态框中显示的书籍简介。
                    `data-spine-text` 是显示在书脊上的文本。
                    
                    注意：对于PDF文件，`data-cover-url` 应该指向预先生成的PDF第一页缩略图。
                -->
                <div class="book-shelf-item"
                     data-title="太阳系边际探索"
                     data-author="黄俊鑫 孙导航"
                     data-page-url="sun_explorer.html"
                     data-summary="本书详细介绍了Vue.js的核心概念、组件化开发、状态管理以及性能优化等内容，是前端开发者学习Vue的必备指南。"
                     data-cover-url="https://placehold.co/200x280/FFD700/000000?text=Vue.js+Book"
                     data-spine-text="Vue.js">
                    <div class="book-container">
                        <div class="book-body">
                            <div class="book-face back-cover"></div>
                            <div class="book-spine"></div>
                            <div class="book-right-side"></div>
                            <div class="book-pages"></div>
                        </div>
                        <div class="book-face front-cover"></div>
                    </div>
                    <div class="book-tooltip">
                        <h4 class="tooltip-title"></h4>
                        <p class="tooltip-author"></p>
                        <p class="tooltip-summary"></p>
                    </div>
                </div>

                <div class="book-shelf-item"
                     data-title="React高级指南"
                     data-author="李四"
                     data-page-url="react-advanced.html"
                     data-summary="本书从Hooks、Context API到性能优化、服务端渲染，全面讲解React高级特性，助你成为React专家。"
                     data-cover-url="https://placehold.co/200x280/87CEEB/000000?text=React+Book"
                     data-spine-text="React">
                    <div class="book-container">
                        <div class="book-body">
                            <div class="book-face back-cover"></div>
                            <div class="book-spine"></div>
                            <div class="book-right-side"></div>
                            <div class="book-pages"></div>
                        </div>
                        <div class="book-face front-cover"></div>
                    </div>
                    <div class="book-tooltip">
                        <h4 class="tooltip-title"></h4>
                        <p class="tooltip-author"></p>
                        <p class="tooltip-summary"></p>
                    </div>
                </div>

                <div class="book-shelf-item"
                     data-title="JavaScript设计模式"
                     data-author="王五"
                     data-page-url="js-design-patterns.pdf"
                     data-summary="探索JavaScript中常用的设计模式，提升代码的可维护性和扩展性，编写更优雅的JavaScript代码。这是一个PDF示例。"
                     data-cover-url="https://placehold.co/200x280/FF6347/ffffff?text=JS+Patterns"
                     data-spine-text="JS设计模式">
                    <div class="book-container">
                        <div class="book-body">
                            <div class="book-face back-cover"></div>
                            <div class="book-spine"></div>
                            <div class="book-right-side"></div>
                            <div class="book-pages"></div>
                        </div>
                        <div class="book-face front-cover"></div>
                    </div>
                    <div class="book-tooltip">
                        <h4 class="tooltip-title"></h4>
                        <p class="tooltip-author"></p>
                        <p class="tooltip-summary"></p>
                    </div>
                </div>
            </div>

            <div class="bookshelf-row"></div>
            <div id="bookshelf-container-2" class="bookshelf-books-display">
                <div class="book-shelf-item"
                     data-title="CSS揭秘"
                     data-author="赵六"
                     data-page-url="css-secrets.html"
                     data-summary="本书揭示了CSS的许多不为人知的技巧和高级用法，让你能够创作出更具创意和表现力的网页界面。"
                     data-cover-url="https://placehold.co/200x280/90EE90/000000?text=CSS+Secrets"
                     data-spine-text="CSS揭秘">
                    <div class="book-container">
                        <div class="book-body">
                            <div class="book-face back-cover"></div>
                            <div class="book-spine"></div>
                            <div class="book-right-side"></div>
                            <div class="book-pages"></div>
                        </div>
                        <div class="book-face front-cover"></div>
                    </div>
                    <div class="book-tooltip">
                        <h4 class="tooltip-title"></h4>
                        <p class="tooltip-author"></p>
                        <p class="tooltip-summary"></p>
                    </div>
                </div>

                <div class="book-shelf-item"
                     data-title="Web性能优化"
                     data-author="钱七"
                     data-page-url="web-performance.pdf"
                     data-summary="从网络、渲染到资源加载，全面讲解Web性能优化策略，提升用户体验和网站加载速度。这是一个PDF示例。"
                     data-cover-url="https://placehold.co/200x280/DA70D6/ffffff?text=Web+Perf"
                     data-spine-text="Web性能">
                    <div class="book-container">
                        <div class="book-body">
                            <div class="book-face back-cover"></div>
                            <div class="book-spine"></div>
                            <div class="book-right-side"></div>
                            <div class="book-pages"></div>
                        </div>
                        <div class="book-face front-cover"></div>
                    </div>
                    <div class="book-tooltip">
                        <h4 class="tooltip-title"></h4>
                        <p class="tooltip-author"></p>
                        <p class="tooltip-summary"></p>
                    </div>
                </div>

                </div>
            <div class="bookshelf-row"></div> </div>
    </main>

    <!--
        -------------------------------------------------------------------
        左侧信息面板 (Book Info Panel)：
        点击书本后从左侧滑入，展示书籍详细信息。
        -------------------------------------------------------------------
    -->
    <div id="bookInfoPanel" class="book-info-panel">
        <span class="close-panel-btn">&times;</span>
        <div class="book-cover-display" id="panelBookCover"></div>
        <h3 id="panelBookTitle" class="text-gray-900 dark:text-white"></h3>
        <p id="panelBookAuthor" class="text-gray-700 dark:text-gray-300"></p>
        <p id="panelBookSummary" class="text-gray-800 dark:text-gray-200"></p>
        <div class="panel-buttons">
            <button id="panelCloseBtn" class="px-6 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition duration-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 btn-primary">
                关闭
            </button>
            <button id="panelGoToDetailsBtn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition duration-300 btn-primary">
                进入详情页
            </button>
        </div>
    </div>

    <!--
        -------------------------------------------------------------------
        底部 (Footer) 部分：
        与主页保持一致。
        -------------------------------------------------------------------
    -->
    <footer class="bg-gray-800 text-white py-8 mt-12 dark:bg-gray-900">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">我的主页 © 2024</p>
            <p class="mb-2">你的备案号 (如果需要)</p>
            <p class="text-sm">Designed by <a href="#" class="text-blue-400 hover:underline">你的名字</a></p>
            <p class="text-sm">Powered by HTML/CSS/Three.js</p>
        </div>
    </footer>

    <!--
        -------------------------------------------------------------------
        JavaScript 脚本部分：
        用于实现页面的交互和动态效果，包括暗黑模式、导航栏、Three.js背景和书籍3D效果。
        -------------------------------------------------------------------
    -->
    <script>
        /*
            暗黑模式切换功能：
            与主页功能一致，控制页面的亮色/暗色主题。
        */
        const themeToggle = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;

        themeToggle.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                htmlElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                themeToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon');
            } else {
                htmlElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                themeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
            }
        });

        // 根据本地存储设置初始主题
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            htmlElement.classList.add('dark');
            themeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
        } else {
            htmlElement.classList.remove('dark');
            themeToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon');
        }

        /*
            导航栏滚动效果：
            与主页功能一致，滚动时导航栏背景和阴影变化。
        */
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });

        /*
            Three.js 3D 场景设置和动画：
            创建并管理背景中的动态粒子效果，与主页功能一致。
        */
        let scene, camera, renderer, particles, mouseX = 0, mouseY = 0;
        const canvas = document.getElementById('threejs-background');

        function initThreeJS() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / canvas.clientHeight, 0.1, 1000);
            camera.position.z = 5;
            renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
            renderer.setSize(window.innerWidth, canvas.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            const geometry = new THREE.BufferGeometry();
            const vertices = [];
            const particleCount = 1000;

            for (let i = 0; i < particleCount; i++) {
                const x = (Math.random() - 0.5) * 20;
                const y = (Math.random() - 0.5) * 20;
                const z = (Math.random() - 0.5) * 20;
                vertices.push(x, y, z);
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));

            const material = new THREE.PointsMaterial({
                color: 0x888888,
                size: 0.05,
                transparent: true,
                opacity: 0.7
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            document.addEventListener('mousemove', onDocumentMouseMove);
            window.addEventListener('resize', onWindowResize);
        }

        function onDocumentMouseMove(event) {
            mouseX = (event.clientX - window.innerWidth / 2) / 200;
            mouseY = (event.clientY - canvas.clientHeight / 2) / 200;
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / canvas.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, canvas.clientHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            particles.rotation.x += 0.0005;
            particles.rotation.y += 0.001;
            camera.position.x += (mouseX - camera.position.x) * 0.05;
            camera.position.y += (-mouseY - camera.position.y) * 0.05;
            camera.lookAt(scene.position);
            renderer.render(scene, camera);
        }

        /*
            -------------------------------------------------------------------
            书籍3D交互、信息面板和页面跳转处理：
            这是实现书籍“拿出打开”效果、显示信息面板和处理跳转/复原的JavaScript逻辑。
            -------------------------------------------------------------------
        */
        const bookShelfItems = document.querySelectorAll('.book-shelf-item'); // 获取所有书本元素
        const bookInfoPanel = document.getElementById('bookInfoPanel'); // 获取左侧信息面板
        const closePanelBtn = document.querySelector('.close-panel-btn'); // 信息面板关闭按钮 (X)
        const panelCloseBtn = document.getElementById('panelCloseBtn'); // 信息面板中的“关闭”按钮
        const panelGoToDetailsBtn = document.getElementById('panelGoToDetailsBtn'); // 信息面板中的“进入详情页”按钮
        const mainContent = document.getElementById('main-content'); // 获取主内容区域，用于模糊效果

        const panelBookCover = document.getElementById('panelBookCover'); // 面板中的封面
        const panelBookTitle = document.getElementById('panelBookTitle'); // 面板中的标题
        const panelBookAuthor = document.getElementById('panelBookAuthor'); // 面板中的作者
        const panelBookSummary = document.getElementById('panelBookSummary'); // 面板中的简介

        let currentOpenedBook = null; // 用于存储当前被点击打开的书本元素
        let tooltipTimeout = null; // 用于控制鼠标悬停提示框的延迟显示

        bookShelfItems.forEach(item => {
            // 设置书脊文本
            const bookSpine = item.querySelector('.book-spine');
            const spineText = item.dataset.spineText;
            if (spineText) {
                bookSpine.textContent = spineText;
            }

            // 设置书籍封面图片
            const frontCover = item.querySelector('.front-cover');
            const coverUrl = item.dataset.coverUrl;
            if (coverUrl) {
                frontCover.style.backgroundImage = `url('${coverUrl}')`;
            }

            // 鼠标悬停显示信息 (Tooltip)
            item.addEventListener('mouseover', (event) => {
                // 如果有书本被点击打开，则不显示 tooltip
                if (currentOpenedBook) return;

                const tooltip = item.querySelector('.book-tooltip');
                if (tooltip) {
                    // 清除之前的延迟，防止快速移动时闪烁
                    clearTimeout(tooltipTimeout);
                    tooltipTimeout = setTimeout(() => {
                        tooltip.querySelector('.tooltip-title').textContent = item.dataset.title || '无标题';
                        tooltip.querySelector('.tooltip-author').textContent = `作者: ${item.dataset.author || '未知'}`;
                        tooltip.querySelector('.tooltip-summary').textContent = item.dataset.summary || '无简介';
                        
                        // 获取鼠标位置，并相对于书本元素定位提示框
                        const itemRect = item.getBoundingClientRect();
                        // 将tooltip定位在书本上方，并水平居中
                        tooltip.style.left = `${itemRect.width / 2}px`;
                        // 调整 top 值，使其在书本上方留出一些空间
                        tooltip.style.top = `${-tooltip.offsetHeight - 15}px`; // 15px 偏移量
                        tooltip.classList.add('show');
                    }, 300); // 延迟300ms显示
                }
            });

            item.addEventListener('mouseout', () => {
                clearTimeout(tooltipTimeout); // 鼠标移开时立即清除延迟
                const tooltip = item.querySelector('.book-tooltip');
                if (tooltip) {
                    tooltip.classList.remove('show');
                }
            });


            // 为每本书本添加点击事件监听器
            item.addEventListener('click', () => {
                const frontCoverElement = item.querySelector('.front-cover'); // 获取封面元素
                
                // 如果有其他书本已经打开，先复原它们
                if (currentOpenedBook && currentOpenedBook !== item) {
                    currentOpenedBook.classList.remove('is-pulled-out');
                    currentOpenedBook.querySelector('.front-cover').classList.remove('is-open'); // 确保关闭旧书的封面
                }

                // 记录当前打开的书本
                currentOpenedBook = item;

                // 1. 触发“拿出”动画
                item.classList.add('is-pulled-out');
                // 确保点击的书本在拿出时透明度为1，不受波浪效果影响
                item.style.setProperty('--wave-opacity', '1');
                item.style.setProperty('--wave-translate-y', '0px');


                // 2. 延迟后触发“翻开”动画并显示信息面板
                setTimeout(() => {
                    frontCoverElement.classList.add('is-open'); // 触发封面翻开动画

                    // 填充信息面板内容
                    panelBookCover.style.backgroundImage = `url('${item.dataset.coverUrl}')`;
                    panelBookTitle.textContent = item.dataset.title;
                    panelBookAuthor.textContent = `作者: ${item.dataset.author}`;
                    panelBookSummary.textContent = item.dataset.summary;

                    // 设置“进入详情页”按钮的跳转URL
                    panelGoToDetailsBtn.dataset.pageUrl = item.dataset.pageUrl;

                    // 显示信息面板并添加模糊效果
                    bookInfoPanel.classList.add('show');
                    mainContent.classList.add('main-blurred'); // 添加模糊效果
                }, 600); // 等待“拿出”动画完成 (book-shelf-item transition 0.6s)
            });
        });

        // 关闭信息面板逻辑 (通过X按钮或“关闭”按钮)
        function closeInfoPanel() {
            bookInfoPanel.classList.remove('show'); // 移除 'show' 类，触发面板关闭动画
            mainContent.classList.remove('main-blurred'); // 移除模糊效果
            setTimeout(() => {
                // 复原当前打开的书本
                if (currentOpenedBook) {
                    currentOpenedBook.classList.remove('is-pulled-out');
                    currentOpenedBook.querySelector('.front-cover').classList.remove('is-open'); // 确保关闭封面
                    currentOpenedBook = null; // 清空当前打开的书本
                }
                // 确保在关闭面板后，波浪效果可以重新作用于所有书籍
                resetWaveEffect();
            }, 400); // 面板关闭动画时间 (与CSS transition 0.4s 匹配)
        }

        closePanelBtn.addEventListener('click', closeInfoPanel); // X按钮
        panelCloseBtn.addEventListener('click', closeInfoPanel); // “关闭”按钮

        // “进入详情页”按钮点击逻辑
        panelGoToDetailsBtn.addEventListener('click', () => {
            const pageUrl = panelGoToDetailsBtn.dataset.pageUrl;
            if (pageUrl) {
                // 动态构建完整的URL，以确保在GitHub Pages上正确解析
                const currentPath = window.location.pathname;
                // 获取当前页面的目录路径（例如：/my-repo/ 或 /）
                const currentDir = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
                const fullUrl = window.location.origin + currentDir + pageUrl;

                // 判断文件类型：如果是PDF，则直接打开；否则，按HTML页面跳转
                if (pageUrl.toLowerCase().endsWith('.pdf')) {
                    window.open(fullUrl, '_blank'); // 在新标签页打开PDF
                } else {
                    window.location.href = fullUrl; // 跳转到HTML页面
                }
            }
        });

        /*
            -------------------------------------------------------------------
            搜索功能逻辑：
            根据用户输入的关键词过滤显示的书籍。
            -------------------------------------------------------------------
        */
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const clearSearchButton = document.getElementById('clearSearchButton');
        // 收集所有书本容器，包括不同书架上的
        const allBookShelfItems = document.querySelectorAll('.bookshelf-books-display .book-shelf-item');

        function filterBooks() {
            const query = searchInput.value.toLowerCase().trim(); // 获取搜索关键词并转换为小写，去除首尾空格

            allBookShelfItems.forEach(item => {
                const title = item.dataset.title ? item.dataset.title.toLowerCase() : '';
                const author = item.dataset.author ? item.dataset.author.toLowerCase() : '';
                const summary = item.dataset.summary ? item.dataset.summary.toLowerCase() : '';
                const spineText = item.dataset.spineText ? item.dataset.spineText.toLowerCase() : '';

                // 检查书名、作者、简介或书脊文本是否包含关键词
                // 现有的 includes() 方法已经支持中英文搜索
                if (title.includes(query) || author.includes(query) || summary.includes(query) || spineText.includes(query)) {
                    item.style.display = 'block'; // 显示匹配的书本
                } else {
                    item.style.display = 'none'; // 隐藏不匹配的书本
                }
            });
        }

        // 搜索按钮点击事件
        searchButton.addEventListener('click', filterBooks);

        // 搜索框输入事件 (实时过滤)
        searchInput.addEventListener('keyup', (event) => {
            if (event.key === 'Enter') { // 按下回车键时也触发搜索
                filterBooks();
            } else if (searchInput.value.trim() === '') { // 如果搜索框清空，则显示所有书籍
                filterBooks(); // 重新调用过滤，因为query为空时会显示所有
            }
        });

        // 清除按钮点击事件
        clearSearchButton.addEventListener('click', () => {
            searchInput.value = ''; // 清空搜索框
            filterBooks(); // 重新过滤，显示所有书籍
        });

        /*
            -------------------------------------------------------------------
            书本波浪动画逻辑：
            鼠标在书架区域移动时，书本产生起伏和淡化效果。
            -------------------------------------------------------------------
        */
        const bookshelfDisplays = document.querySelectorAll('.bookshelf-books-display'); // 获取所有书架显示区域

        const influenceRadius = 150; // 鼠标影响范围（像素）
        const maxPopOut = -25; // 最大突出量（向上移动的像素）
        const minOpacity = 0.4; // 最小透明度（最淡化时的透明度）

        function applyWaveEffect(event) {
            // 如果有书本被点击打开，暂停波浪效果
            if (currentOpenedBook) {
                // 确保当前打开的书本不受波浪影响
                if (currentOpenedBook.style.getPropertyValue('--wave-opacity') !== '1') {
                     currentOpenedBook.style.setProperty('--wave-opacity', '1');
                     currentOpenedBook.style.setProperty('--wave-translate-y', '0px');
                }
                return;
            }

            const mouseX = event.clientX; // 鼠标的X坐标

            allBookShelfItems.forEach(item => {
                // 隐藏所有 tooltip，避免波浪动画时的闪烁
                const tooltip = item.querySelector('.book-tooltip');
                if (tooltip) {
                    tooltip.classList.remove('show');
                    clearTimeout(tooltipTimeout); // 清除延迟
                }

                const itemRect = item.getBoundingClientRect();
                const itemCenterX = itemRect.left + itemRect.width / 2; // 书本中心的X坐标
                const distance = Math.abs(mouseX - itemCenterX); // 鼠标与书本中心的距离

                if (distance < influenceRadius) {
                    // 计算效果强度 (0到1之间)
                    // 使用 Math.pow(..., 2) 创建一个二次方缓出效果，使效果更集中在鼠标附近，更丝滑
                    const effectStrength = Math.pow(1 - (distance / influenceRadius), 2);

                    // 计算突出量：距离鼠标越近，突出越多（向上移动）
                    const popOutAmount = maxPopOut * effectStrength;

                    // 计算透明度：距离鼠标越近，越不透明（越亮）
                    // 从 minOpacity (0.4) 到 1 变化
                    const currentOpacity = minOpacity + (1 - minOpacity) * effectStrength;

                    item.style.setProperty('--wave-translate-y', `${popOutAmount}px`);
                    item.style.setProperty('--wave-opacity', `${currentOpacity}`);
                } else {
                    // 鼠标超出影响范围的书本，恢复到初始状态
                    item.style.setProperty('--wave-translate-y', '0px');
                    item.style.setProperty('--wave-opacity', '1');
                }
            });
        }

        // 鼠标离开书架区域时，恢复所有书本状态
        function resetWaveEffect() {
            allBookShelfItems.forEach(item => {
                item.style.setProperty('--wave-translate-y', '0px');
                item.style.setProperty('--wave-opacity', '1');
            });
        }

        // 为每个书架容器添加鼠标移动和离开事件监听
        bookshelfDisplays.forEach(shelf => {
            shelf.addEventListener('mousemove', applyWaveEffect);
            shelf.addEventListener('mouseleave', resetWaveEffect);
        });


        // 页面加载完成后执行：初始化 Three.js
        window.onload = function () {
            initThreeJS(); // 初始化Three.js
            animate(); // 启动动画循环
        };
    </script>
</body>
</html>
